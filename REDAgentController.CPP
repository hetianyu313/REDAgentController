#define wv3mz1p7kz BOOL
#define q63b9sfkv8 BitBlt
#define z853kl7xns BringWindowToTop
#define dk4d352oby CALLBACK
#define looggw11xq CHAR
#define lme9dmrl0j COLORREF
#define u4iotmtncb COORD
#define wg3vjck58n CP_ACP
#define y20piqodt1 CTRL_CLOSE_EVENT
#define kaqw41fzig CTRL_LOGOFF_EVENT
#define tfv2u01jh1 CTRL_SHUTDOWN_EVENT
#define a3tz4h8d62 CallNextHookEx
#define d31o106vpy ClearWindowContent
#define r9tv57ls4q CloseHandle
#define iuj2wu63zz ConsoleHandler
#define m7pb5ckivt CreateCompatibleBitmap
#define g6w1esqevw CreateCompatibleDC
#define a7kpah2kpk CreateFontIndirectA
#define l8f8hxvjrn CreateSolidBrush
#define g9yfdgwtil CreateToolhelp32Snapshot
#define rhliyf4mj3 DWORD
#define c0m1h7m3ej DWORD_PTR
#define qlmgiuxc0t DeleteDC
#define cvsb70e3hy DeleteMenu
#define sa3b452jb7 DeleteObject
#define kb34lir653 DestroyWindow
#define q0m77ge9i3 DrawMenuBar
#define b5khhbmk4o EnableMenuItem
#define escsojx0cz EnumData
#define pxzw3nepuo EnumProcessModules
#define fzrjajvu9z EnumProcesses
#define gib6i3ls7w EnumWindows
#define f5b9cbevl3 EnumWindowsProc
#define mbl1om6shj FALSE
#define wt946mxv5p FillRect
#define cteqxwv3qq FindProcessId
#define ppd0i2zumj FindWindowsByProcessName
#define nab2gynlnd ForceRefreshWindow
#define m9fwikz66e GWL_STYLE
#define tn8xujjk3y GetAsyncKeyState
#define tta7blyu2w GetClientRect
#define ttbsp82nsu GetConsoleWindow
#define zc2iwa1bkb GetCurrentProcessId
#define kfin2ov084 GetCurrentThreadId
#define tb9c0s6ha4 GetCurrentUsername
#define hxgca0j25x GetDC
#define nr6fimna4i GetDeviceCaps
#define kff18gfo5p GetGUIThreadInfo
#define sb7se10rvk GetLastError
#define wrlzm169nj GetModuleFileName
#define apbigdlxyf GetModuleFileNameEx
#define bfkmkh7gjp GetModuleHandle
#define a2mzpt6boy GetProcAddress
#define beluku71p3 GetStdHandle
#define iis38p3nvw GetSystemMenu
#define o09mceonxh GetSystemMetrics
#define oa9glapsz6 GetThreadDesktop
#define xituprgqoj GetUserNameA
#define bgfco79ign GetWindowLong
#define boeaewck2i GetWindowLongPtr
#define c8tx092jtq GetWindowPlacement
#define c0cxiwbc4x GetWindowRect
#define iz1z8908zf GetWindowThreadProcessId
#define t4073nre1z HANDLE
#define k4twq98a2g HBITMAP
#define rbsdhrff8b HBRUSH
#define q2u60zo00b HC_ACTION
#define iye74mzujq HDC
#define bj6rz2btk9 HFONT
#define ngrtu8wccn HHOOK
#define ddjqu2uiph HICON
#define k227dhaltd HMENU
#define lnpuz8bp8l HMODULE
#define atxtuyv608 HWND
#define s0qfpi0gin HWND_NOTOPMOST
#define ypeeoht7ra HWND_TOPMOST
#define k6wolxopsn ICON_BIG
#define nlmg8aqz8q ICON_SMALL
#define tu3gwmz9g3 ICON_SMALL2
#define vguybgzqo8 IMAGE_ICON
#define w2bhhvyl9a INVALID_HANDLE_VALUE
#define wl2nhqm0bf IsWindow
#define pu5vdfjdso IsWindowVisible
#define c7qt6uz2xn KBDLLHOOKSTRUCT
#define yigk87vzbu LF_FACESIZE
#define h8ewt62uka LOGFONTA
#define jirqt1w8ev LOGPIXELSY
#define ab377wnxi4 LONG_PTR
#define wy915q0u6w LPARAM
#define eteiwlvd5w LPCSTR
#define c8c10xtld2 LR_DEFAULTSIZE
#define wylhbfykh1 LR_LOADFROMFILE
#define m6doze6twk LoadImage
#define de89ot1cca MAX_PATH
#define bqbaudadmr MF_BYCOMMAND
#define rrdydhk4nj MF_GRAYED
#define m5khjno7kh MulDiv
#define egnh2jn3pi NTAPI
#define y538t31mjr NTSTATUS
#define p53i3n3xk4 NT_SUCCESS
#define e8kyh1iojo NULL
#define b8lmhy06mi NtClose
#define vxm5a3i3z4 NtQuerySystemInformation
#define hfw46y1fvd NtQuerySystemInformation_t
#define zcpq6lwsvt OpenProcess
#define uxtlph560x OpenThread
#define z01skxvg4i PROCESSENTRY32
#define r0uyzs0q2p PROCESS_ALL_ACCESS
#define lziblyjwid PROCESS_QUERY_INFORMATION
#define y6886nt98d PROCESS_TERMINATE
#define sji9i63uw9 PROCESS_VM_READ
#define b7r24x70l2 PULONG
#define sxpo2b7jr1 PVOID
#define ig3z46tske PostMessage
#define s4p8z6iqmv Process32First
#define spmc44qpts Process32Next
#define jzl93ndxps RDW_ALLCHILDREN
#define oq1qtju2wo RDW_ERASE
#define dw3uds3wkq RDW_INVALIDATE
#define htcp45ndkh RDW_UPDATENOW
#define e5kzbawjlo RECT
#define os5oyegobe RGB
#define izo0w76a43 RedrawWindow
#define nyj6f1rujh RefreshWindows
#define axp4k7d2vp ReleaseDC
#define t4p2cqauu0 RemoveHook
#define flz8uiq64w SC_CLOSE
#define aqnh5xmz0j SHORT
#define hac4iinzgu SMALL_RECT
#define x1qsbbn4ye SM_CXSCREEN
#define nrukmqnhkg SM_CYSCREEN
#define gapozva5xt SRCCOPY
#define osadtpmwa0 STD_OUTPUT_HANDLE
#define tcf7x9grue SWP_FRAMECHANGED
#define ip1jgtr29e SWP_NOMOVE
#define s4mx33725s SWP_NOOWNERZORDER
#define bm2lnx4etq SWP_NOSIZE
#define evplwrsd68 SWP_NOZORDER
#define cnn1dy5l2j SYSTEM_INFORMATION_CLASS
#define zqu4sr2bcg SelectObject
#define i0ru6bn603 SendMessage
#define e7o42rw6fd SetConsoleCP
#define sk7quwwuz4 SetConsoleCtrlHandler
#define i1z43xaaf4 SetConsoleScreenBufferSize
#define xxq7wfkhvx SetConsoleTitle
#define ofbgnaqcgo SetConsoleTopMost
#define fihza63kw7 SetConsoleWindowInfo
#define zjompfwoek SetConsoleWindowSize
#define sz38wfs4v0 SetForegroundWindow
#define rn5j2ttaaz SetHook
#define sjc5qgevi6 SetWindowLong
#define xau9xxsz0v SetWindowLongPtr
#define zv6s6ur1sw SetWindowPlacement
#define kzqgjmaj29 SetWindowPos
#define hbdegc5fe2 Sleep
#define m7f30xzht4 TEXT
#define m2fqgm6elb TH32CS_SNAPPROCESS
#define dcj1hx5fb2 TH32CS_SNAPTHREAD
#define k93vnygozn THREADENTRY32
#define qtmx80ayce THREAD_QUERY_INFORMATION
#define gt94whrof7 TRUE
#define p3v7mz2vrz TerminateProcess
#define goqoay5gha TextOutA
#define p0hm9c7yr1 Thread32First
#define cedot75mpx Thread32Next
#define jzriqqu7un ThreadA_Function
#define qw6jo5cpq5 ThreadB_Function
#define iahjrnz5u2 ThreadC_Function
#define r3rc8dddk3 ThreadD_Function
#define proivd2hpr ThreadE_Function
#define uhtya7wr8b ThreadF_Function
#define acypr6vrbw ThreadG_Function
#define vyb5obch2t ThreadH_Function
#define y2yqqfgkk4 ThreadKZ_Function
#define bgrdtfzsxr ToggleWindowMode
#define lr2w5fwynx ULONG
#define ym5nvcpc41 UNLEN
#define uxj9ym5q1h UnhookWindowsHookEx
#define qavvys05gd VK_CONTROL
#define ex9bq9m505 VK_ESCAPE
#define zou6h581a6 WH_KEYBOARD
#define zc3qxjfg1v WH_KEYBOARD_LL
#define ugixnoowcc WINAPI
#define e0xileshbg WINDOWPLACEMENT
#define qaokfknw8z WM_CLOSE
#define vkg80pkqfw WM_KEYDOWN
#define oohfzr5sun WM_SETICON
#define smzdxtnra4 WS_CAPTION
#define vpz08hk7ci WS_MAXIMIZEBOX
#define ixbng959we WS_OVERLAPPEDWINDOW
#define o592cm4q9q WS_THICKFRAME
#define lp0k7mun46 atomic
#define d5a8a1en5s auto
#define exzmjjdh9g bgColor
#define uexolj4ng7 bool
#define nbcbrlhr33 bottom
#define kibun78sck break
#define eilimtwfqg buffer
#define p3spqjk0zg bufferSize
#define zohik3uvh4 c
#define qi00p5qpws cProcesses
#define rhv8fm036y c_str
#define bqnef05due case
#define aklrg0ym5r cbNeeded
#define cgybkx10qb cbNeededMod
#define fhpje7qw11 cerr
#define xbj2jnnuty char
#define bf6ldcu73b choice
#define yc78em91px chrono
#define ulspl9t1rr chrono_to_string
#define f0e0ej6sct cin
#define i6mp1bnf5l clientRect
#define mlw46kmmzz closewindowpro
#define lddynrrhtc const
#define uq0k75t90b continue
#define coit9c6mq9 count
#define bpxwbsxkw5 cout
#define vtot0uzi0g data
#define a0eyjn263k default
#define x7zv1yzpay do
#define lmxo2qacwv dwSize
#define m3sqp6gpq2 else
#define ngodngutyb end
#define atyztj3b08 endl
#define hlz2bwaxn6 error
#define i2oy5gu6yt exedir
#define hhanf61ntc false
#define ylust28pv1 find
#define yvo638fqx3 find_last_of
#define cnb9s5snaw first
#define wv67vtxphx fontName
#define d15m82li6g for
#define j2hokgu88c g_kzjc
#define mo26pkdsj7 g_kzjcwl
#define dzc6icsru0 g_running
#define bv93u9tnhg g_threadA_active
#define byjy6mp664 g_threadB_active
#define b6scsgjh1p g_threadC_active
#define u5dm2ao24q g_threadE_active
#define zpksmflq9f g_threadF_active
#define muokb8ff4b g_threadG_active
#define ajqe17ch63 g_threadH_active
#define fauovls9yv getexedir
#define ra8f4huqkm getline
#define h9tqn8qyrs getopen
#define sek2muy4wr getpidbyhwnd
#define ooq857fn7j hBitmap
#define xd5cn3qn2z hBrush
#define be4uzhs33a hFont
#define b5n0wgodua hIcon
#define yyxktk19ir hMemDC
#define bbqbmxloxe hMenu
#define c68labfcjq hMod
#define w5n4stslsv hOldBitmap
#define m2q3ysgaye hProcess
#define r7ryhbowtc hSnapshot
#define ek5pc06tr2 hStdout
#define o4keehtw63 hThread
#define si4d5070sy handles
#define aag68t6asp hdc
#define fgywhkniuh height
#define rsyjvbn9wm hideclose
#define x6r2ykxn36 hook
#define sx2xo7aoe0 hwnd
#define maac7khmgy i
#define v7enqa7lhf icon
#define ccwp19ggor if
#define s8kbmtqwnr int
#define iolres1z04 join
#define y5xc39a6zs kill_exe
#define n7scf0g66d kz
#define sf03p65cxx lParam
#define ka5l5lxj43 left
#define wks5jxpbnh len
#define t99cm924xm length
#define sxq90cmyfg lf
#define rl33cy7lfs lfFaceName
#define ghw6wi1cxo lfHeight
#define lhzb1wy1rq localtime_r
#define ujpcp1u5k9 m_brk
#define q53i3o1sar main
#define f74jjmc280 milliseconds
#define ett2whlc6b nCode
#define kmj1w9a737 name
#define jd740jinwb namespace
#define q8ab0bkb7d newmsg
#define xzwpg66hvd npos
#define l6tya0kpbh ntdll
#define wp6zd5matj nullptr
#define p0c6lzmuj2 nwb
#define qe1216pt8k op
#define ofmptctekf ops
#define plqf6f5nv9 p
#define ph41vivl8c pair
#define b68z7ngips path
#define lz6uv7ep52 pe32
#define gmp5pit1er pid
#define kfnjwcwhjv processId
#define mx8ml2xb2r processName
#define nwhu09me7l processes
#define w84u5dlx7r push_back
#define wf07lkm7ai r
#define k9fy6gc758 rect
#define k3xpww12hi reinterpret_cast
#define hlovahj353 result
#define tmpiefzjqx return
#define lsauaenj9p right
#define q9gtmvamsi s
#define xc6oi3agfh safetoi
#define uxwgl650nl second
#define vchszdw5v4 setfont
#define jshq5bzzsj seticon
#define whuc6xvc2w signal
#define obfpyjt00u sizeof
#define d3fhs13yui sleep_for
#define tatvswbtxa ss
#define ttnml6x8th static
#define proi6qkigj static_cast
#define ia2pgwdt68 status
#define be50h4vwjh std
#define aenmdq3n16 str
#define au9n2hos54 strcmp
#define momszqvu98 strftime
#define ziutfva616 string
#define nc2ademy17 stringstream
#define oc6dykhcvr strncpy
#define db72paotpi struct
#define oviw9obins style
#define o4wnqjkj86 substr
#define cpknk31k6g switch
#define vz3u1bmlmy sx
#define my0wxtvo67 sy
#define vdncx9w0n9 system
#define rjdclgn28a system_clock
#define dye0qfg39s szExeFile
#define x760nx67vl szModName
#define of0rr91nnx szProcessName
#define s6brvxvlc5 t
#define hjnuv8wecn te32
#define pz6ebp52bg text
#define xcfi3lgma2 th32OwnerProcessID
#define ihkaet880q th32ProcessID
#define qf1y1fef7b th32ThreadID
#define p2l2xhp421 this_thread
#define s99ytwe5gn thread
#define sbe8hh259p threadA
#define gvy3piwhl4 threadB
#define cf23t16ao2 threadC
#define sisyqyfg02 threadD
#define z565hmu2v1 threadE
#define dvivvigwa1 threadF
#define t8rcv1m6mq threadG
#define alt93dl3nt threadH
#define vu6fvw5noi threadId
#define fy4ol77tfo time
#define qfjqefdkm0 time_point
#define hphf39iogh time_t
#define wd3isvpyi9 time_to_string
#define tntesfhscd timestamp
#define sszhz8s1sa tm
#define ti79is4os2 tm_info
#define hqbsg4hikj to_time_t
#define aq2bdz6w9a top
#define p3arcvus1v topmost
#define d0jut6ov1v tp
#define q7t0bezcwn true
#define q3j0cththh typedef
#define la6txb92qc uhdc
#define yabml2i88t unordered_map
#define r6o7uswnzv unsigned
#define oqmdun6mnl username
#define z6d6vqz8a2 username_len
#define ynbo0bbtrv using
#define igj59u8jis v
#define g9hldylrf0 vector
#define dy9t7gnpmx vkCode
#define fzncjtajgl void
#define np0jfebg8b w
#define t5wc87qw8u wParam
#define wfo9mvh3ss while
#define m1b97ogv5v width
#define axml7stugn windowSize
#define q0dm4mazts windowStates
#define wb96u2yqdg windowed
#define e9sg3ugwss windows
#define ad3vhuphyb wpPrev
#define ley33f7fl0 wstring
#include <winsock2.h>
#include <windows.h>
#include <psapi.h>
#include <winuser.h>
#include <atomic>
#include <thread>
#include <string>
#include <ctime>
#include <chrono>
#include <iomanip>
#include <bits/stdc++.h>
#include <shellapi.h>
#include <ntdef.h>
#include <mutex>
#include <tlhelp32.h>
#include <shlobj.h>
#include <psapi.h>
#include <ntstatus.h>
#include <Lmcons.h>
#include "NetBlocker.cpp"
#include <winternl.h>
#include <tchar.h>
ynbo0bbtrv jd740jinwb be50h4vwjh; //-lpsapi -lntdll -lgdi32 -std=c++14 -O2 -s -lws2_32 -m32
//32bit mode
lp0k7mun46<uexolj4ng7> bv93u9tnhg(hhanf61ntc); lp0k7mun46<uexolj4ng7> byjy6mp664(hhanf61ntc); lp0k7mun46<uexolj4ng7> b6scsgjh1p(hhanf61ntc); lp0k7mun46<uexolj4ng7> u5dm2ao24q(hhanf61ntc);
lp0k7mun46<uexolj4ng7> zpksmflq9f(hhanf61ntc); lp0k7mun46<uexolj4ng7> muokb8ff4b(hhanf61ntc); lp0k7mun46<uexolj4ng7> ajqe17ch63(hhanf61ntc); lp0k7mun46<uexolj4ng7> j2hokgu88c(hhanf61ntc);//测试：控制进程运行 
lp0k7mun46<uexolj4ng7> mo26pkdsj7(hhanf61ntc);//测试：控制进程网络 
lp0k7mun46<uexolj4ng7> dzc6icsru0(q7t0bezcwn); ttnml6x8th lddynrrhtc ziutfva616 y5xc39a6zs = "REDAgent.exe"; db72paotpi escsojx0cz { rhliyf4mj3 gmp5pit1er;
g9hldylrf0<atxtuyv608>* si4d5070sy; }; wv3mz1p7kz dk4d352oby f5b9cbevl3(atxtuyv608 sx2xo7aoe0, wy915q0u6w sf03p65cxx); g9hldylrf0<atxtuyv608> ppd0i2zumj(lddynrrhtc xbj2jnnuty* mx8ml2xb2r) {
g9hldylrf0<atxtuyv608> hlovahj353; rhliyf4mj3 gmp5pit1er = 0; z01skxvg4i lz6uv7ep52 = { obfpyjt00u(z01skxvg4i) }; // 获取进程ID
t4073nre1z r7ryhbowtc = g9yfdgwtil(m2fqgm6elb, 0); ccwp19ggor (s4p8z6iqmv(r7ryhbowtc, &lz6uv7ep52)) { x7zv1yzpay { ccwp19ggor (au9n2hos54(lz6uv7ep52.dye0qfg39s, mx8ml2xb2r) == 0) {
gmp5pit1er = lz6uv7ep52.ihkaet880q; kibun78sck; } } wfo9mvh3ss (spmc44qpts(r7ryhbowtc, &lz6uv7ep52)); } r9tv57ls4q(r7ryhbowtc); ccwp19ggor (gmp5pit1er == 0) tmpiefzjqx hlovahj353;
// 枚举窗口
escsojx0cz vtot0uzi0g = { gmp5pit1er, &hlovahj353 }; gib6i3ls7w(f5b9cbevl3, k3xpww12hi<wy915q0u6w>(&vtot0uzi0g)); tmpiefzjqx hlovahj353; } wv3mz1p7kz dk4d352oby f5b9cbevl3(atxtuyv608 sx2xo7aoe0, wy915q0u6w sf03p65cxx) {
escsojx0cz* vtot0uzi0g = k3xpww12hi<escsojx0cz*>(sf03p65cxx); rhliyf4mj3 kfnjwcwhjv = 0; iz1z8908zf(sx2xo7aoe0, &kfnjwcwhjv); ccwp19ggor (kfnjwcwhjv == vtot0uzi0g->gmp5pit1er && pu5vdfjdso(sx2xo7aoe0)) {
vtot0uzi0g->si4d5070sy->w84u5dlx7r(sx2xo7aoe0); } tmpiefzjqx gt94whrof7; } rhliyf4mj3 cteqxwv3qq(lddynrrhtc ziutfva616& mx8ml2xb2r){ rhliyf4mj3 nwhu09me7l[1024],aklrg0ym5r;
ccwp19ggor(!fzrjajvu9z(nwhu09me7l,obfpyjt00u(nwhu09me7l),&aklrg0ym5r))tmpiefzjqx 0; rhliyf4mj3 coit9c6mq9 = aklrg0ym5r / obfpyjt00u(rhliyf4mj3); d15m82li6g(rhliyf4mj3 maac7khmgy = 0;maac7khmgy<coit9c6mq9;maac7khmgy++){
ccwp19ggor(nwhu09me7l[maac7khmgy]==0) uq0k75t90b; t4073nre1z m2q3ysgaye = zcpq6lwsvt(lziblyjwid | sji9i63uw9,mbl1om6shj,nwhu09me7l[maac7khmgy]); ccwp19ggor(m2q3ysgaye){
looggw11xq of0rr91nnx[de89ot1cca] = ""; ccwp19ggor(apbigdlxyf(m2q3ysgaye,e8kyh1iojo,of0rr91nnx,de89ot1cca)){ ziutfva616 kmj1w9a737(of0rr91nnx); ccwp19ggor(kmj1w9a737.ylust28pv1(mx8ml2xb2r) != ley33f7fl0::xzwpg66hvd){
r9tv57ls4q(m2q3ysgaye); tmpiefzjqx nwhu09me7l[maac7khmgy]; } } r9tv57ls4q(m2q3ysgaye); } } tmpiefzjqx 0; } fzncjtajgl d31o106vpy(atxtuyv608 sx2xo7aoe0, lme9dmrl0j exzmjjdh9g = os5oyegobe(255, 255, 255)) {
//lock_guard<mutex> lock(mtx);
ccwp19ggor (!wl2nhqm0bf(sx2xo7aoe0)) tmpiefzjqx; iye74mzujq aag68t6asp = hxgca0j25x(sx2xo7aoe0); e5kzbawjlo i6mp1bnf5l; tta7blyu2w(sx2xo7aoe0, &i6mp1bnf5l);
iye74mzujq yyxktk19ir = g6w1esqevw(aag68t6asp); k4twq98a2g ooq857fn7j = m7pb5ckivt(aag68t6asp, i6mp1bnf5l.lsauaenj9p, i6mp1bnf5l.nbcbrlhr33); k4twq98a2g w5n4stslsv = (k4twq98a2g)zqu4sr2bcg(yyxktk19ir, ooq857fn7j);
rbsdhrff8b xd5cn3qn2z = l8f8hxvjrn(exzmjjdh9g); wt946mxv5p(yyxktk19ir, &i6mp1bnf5l, xd5cn3qn2z); q63b9sfkv8(aag68t6asp, 0, 0, i6mp1bnf5l.lsauaenj9p, i6mp1bnf5l.nbcbrlhr33,
yyxktk19ir, 0, 0, gapozva5xt); zqu4sr2bcg(yyxktk19ir, w5n4stslsv); sa3b452jb7(ooq857fn7j); qlmgiuxc0t(yyxktk19ir); sa3b452jb7(xd5cn3qn2z); axp4k7d2vp(sx2xo7aoe0, aag68t6asp);
izo0w76a43(sx2xo7aoe0, wp6zd5matj, wp6zd5matj, dw3uds3wkq | oq1qtju2wo | jzl93ndxps | htcp45ndkh); } // 强制刷新指定窗口
ttnml6x8th fzncjtajgl nab2gynlnd(atxtuyv608 sx2xo7aoe0) { ccwp19ggor (!wl2nhqm0bf(sx2xo7aoe0)) tmpiefzjqx; // 触发WM_NCCALCSIZE消息重绘非客户区
kzqgjmaj29(sx2xo7aoe0, wp6zd5matj, 0, 0, 0, 0, ip1jgtr29e | bm2lnx4etq | evplwrsd68 | s4mx33725s | tcf7x9grue); // 强制重绘客户区
izo0w76a43(sx2xo7aoe0, wp6zd5matj, wp6zd5matj, dw3uds3wkq | oq1qtju2wo | htcp45ndkh); } // 批量刷新窗口
ttnml6x8th fzncjtajgl nyj6f1rujh(lddynrrhtc g9hldylrf0<atxtuyv608>& e9sg3ugwss) { d15m82li6g (atxtuyv608 sx2xo7aoe0 : e9sg3ugwss) { //ForceRefreshWindow(hwnd);
d31o106vpy(sx2xo7aoe0); } } /*void ToggleWindowMode(HWND hwnd, bool windowed) {
ttnml6x8th e0xileshbg ad3vhuphyb = { obfpyjt00u(e0xileshbg) }; rhliyf4mj3 oviw9obins = bgfco79ign(sx2xo7aoe0, m9fwikz66e); ccwp19ggor (wb96u2yqdg) { // 窗口化模式：添加标题栏、边框和大小调整栏
sjc5qgevi6(sx2xo7aoe0, m9fwikz66e, oviw9obins | ixbng959we | smzdxtnra4 | o592cm4q9q); zv6s6ur1sw(sx2xo7aoe0, &ad3vhuphyb); kzqgjmaj29(sx2xo7aoe0, e8kyh1iojo, 0, 0, 0, 0,
ip1jgtr29e | bm2lnx4etq | evplwrsd68 | s4mx33725s | tcf7x9grue); } m3sqp6gpq2 { // 全屏模式：移除标题栏和边框
ccwp19ggor (c8tx092jtq(sx2xo7aoe0, &ad3vhuphyb)) { sjc5qgevi6(sx2xo7aoe0, m9fwikz66e, oviw9obins & ~(ixbng959we | smzdxtnra4 | o592cm4q9q)); kzqgjmaj29(sx2xo7aoe0, e8kyh1iojo, 0, 0, 0, 0,
ip1jgtr29e | bm2lnx4etq | s4mx33725s | tcf7x9grue); } } }*/ fzncjtajgl bgrdtfzsxr(atxtuyv608 sx2xo7aoe0, uexolj4ng7 wb96u2yqdg) { ttnml6x8th yabml2i88t<atxtuyv608, ph41vivl8c<uexolj4ng7, uexolj4ng7>> q0dm4mazts; // 改为存储状态和是否首次检测
//static mutex mtx;
//lock_guard<mutex> lock(mtx);
ccwp19ggor (!wl2nhqm0bf(sx2xo7aoe0)) tmpiefzjqx; // 检查状态是否已改变
ccwp19ggor (q0dm4mazts.ylust28pv1(sx2xo7aoe0) != q0dm4mazts.ngodngutyb() && q0dm4mazts[sx2xo7aoe0].cnb9s5snaw == wb96u2yqdg) { tmpiefzjqx; } rhliyf4mj3 oviw9obins = bgfco79ign(sx2xo7aoe0, m9fwikz66e);
ccwp19ggor (wb96u2yqdg) { sjc5qgevi6(sx2xo7aoe0, m9fwikz66e, oviw9obins | ixbng959we | smzdxtnra4 | o592cm4q9q); // 首次检测时调整窗口大小
ccwp19ggor (q0dm4mazts.ylust28pv1(sx2xo7aoe0) == q0dm4mazts.ngodngutyb() || !q0dm4mazts[sx2xo7aoe0].uxwgl650nl) { e5kzbawjlo k9fy6gc758; c0cxiwbc4x(sx2xo7aoe0, &k9fy6gc758);
s8kbmtqwnr m1b97ogv5v = k9fy6gc758.lsauaenj9p - k9fy6gc758.ka5l5lxj43; s8kbmtqwnr fgywhkniuh = k9fy6gc758.nbcbrlhr33 - k9fy6gc758.aq2bdz6w9a; kzqgjmaj29(sx2xo7aoe0, e8kyh1iojo, 0, 0, m1b97ogv5v + 12, fgywhkniuh + 30,
ip1jgtr29e | evplwrsd68 | s4mx33725s); q0dm4mazts[sx2xo7aoe0].uxwgl650nl = q7t0bezcwn; // 标记为已调整
} } m3sqp6gpq2 { sjc5qgevi6(sx2xo7aoe0, m9fwikz66e, oviw9obins & ~(ixbng959we | smzdxtnra4 | o592cm4q9q)); } kzqgjmaj29(sx2xo7aoe0, e8kyh1iojo, 0, 0, 0, 0,
ip1jgtr29e | bm2lnx4etq | evplwrsd68 | s4mx33725s | tcf7x9grue); q0dm4mazts[sx2xo7aoe0].cnb9s5snaw = wb96u2yqdg; } fzncjtajgl jzriqqu7un() { wfo9mvh3ss (dzc6icsru0) {
g9hldylrf0<atxtuyv608> igj59u8jis = ppd0i2zumj(y5xc39a6zs.rhv8fm036y()); d15m82li6g (atxtuyv608 sx2xo7aoe0 : igj59u8jis) { ccwp19ggor (sx2xo7aoe0) { bgrdtfzsxr(sx2xo7aoe0, bv93u9tnhg);
} } nyj6f1rujh(igj59u8jis); p2l2xhp421::d3fhs13yui(yc78em91px::f74jjmc280(1000)); } } fzncjtajgl qw6jo5cpq5(){ wfo9mvh3ss(dzc6icsru0){ ccwp19ggor(byjy6mp664){
rhliyf4mj3 gmp5pit1er = cteqxwv3qq(y5xc39a6zs.rhv8fm036y()); ccwp19ggor(gmp5pit1er != 0){ t4073nre1z m2q3ysgaye = zcpq6lwsvt(y6886nt98d,mbl1om6shj,gmp5pit1er);
ccwp19ggor(m2q3ysgaye){ p3v7mz2vrz(m2q3ysgaye,0); r9tv57ls4q(m2q3ysgaye); } } } p2l2xhp421::d3fhs13yui(yc78em91px::f74jjmc280(700)); } } s8kbmtqwnr mlw46kmmzz(atxtuyv608 sx2xo7aoe0,s8kbmtqwnr kfnjwcwhjv){
s8kbmtqwnr wf07lkm7ai = i0ru6bn603(sx2xo7aoe0, qaokfknw8z, 0, 0); // 发送WM_CLOSE消息关闭窗口
//cout<<"closewindowpro:mode 1 return "<<r<<"\n";
wf07lkm7ai = kb34lir653(sx2xo7aoe0); //cout<<"closewindowpro:mode 2 return "<<r<<"\n";
t4073nre1z m2q3ysgaye = zcpq6lwsvt(r0uyzs0q2p, mbl1om6shj, kfnjwcwhjv); // 获取进程句柄
ccwp19ggor (m2q3ysgaye != e8kyh1iojo) { y538t31mjr ia2pgwdt68 = b8lmhy06mi(m2q3ysgaye); // 关闭句柄
wf07lkm7ai = !p53i3n3xk4(ia2pgwdt68); } //cout<<"closewindowpro:mode 3 return "<<r<<"\n";
//cout<<"closewindowpro:ended\n";
} s8kbmtqwnr sek2muy4wr(atxtuyv608 sx2xo7aoe0){ rhliyf4mj3 gmp5pit1er; rhliyf4mj3 vu6fvw5noi = iz1z8908zf(sx2xo7aoe0, &gmp5pit1er); ccwp19ggor (vu6fvw5noi == 0) {
//cout << "getpidbyhwnd:error at getting PID" << endl;
tmpiefzjqx 65535; } tmpiefzjqx gmp5pit1er; } fzncjtajgl iahjrnz5u2(){ wfo9mvh3ss(dzc6icsru0){ ccwp19ggor(b6scsgjh1p){ g9hldylrf0<atxtuyv608> igj59u8jis = ppd0i2zumj(y5xc39a6zs.rhv8fm036y());
d15m82li6g(atxtuyv608 sx2xo7aoe0:igj59u8jis){  ccwp19ggor(sx2xo7aoe0){  ig3z46tske(sx2xo7aoe0,qaokfknw8z,0,0);  mlw46kmmzz(sx2xo7aoe0,sek2muy4wr(sx2xo7aoe0));
 }   } } p2l2xhp421::d3fhs13yui(yc78em91px::f74jjmc280(1300)); } } fzncjtajgl r3rc8dddk3(){ wfo9mvh3ss(dzc6icsru0){  ccwp19ggor((tn8xujjk3y(ex9bq9m505) & 0x8000) && (tn8xujjk3y(qavvys05gd) & 0x8000)){
bv93u9tnhg = !bv93u9tnhg; bpxwbsxkw5<<"Ctrl+Escape pressed 按下组合键\nWindow mode 窗口化模式: " <<(bv93u9tnhg ? "ON": "OFF")<<atyztj3b08; wfo9mvh3ss((tn8xujjk3y(ex9bq9m505) & 0x8000) && (tn8xujjk3y(qavvys05gd) & 0x8000)) p2l2xhp421::d3fhs13yui(yc78em91px::f74jjmc280(250));
 } } } fzncjtajgl ofbgnaqcgo(uexolj4ng7 p3arcvus1v) { atxtuyv608 sx2xo7aoe0 = ttbsp82nsu(); ccwp19ggor (sx2xo7aoe0) { ccwp19ggor(p3arcvus1v){  kzqgjmaj29(sx2xo7aoe0, 
 ypeeoht7ra,  0, 0, 0, 0,  ip1jgtr29e | bm2lnx4etq);  z853kl7xns(sx2xo7aoe0);  sz38wfs4v0(sx2xo7aoe0);  } m3sqp6gpq2{  kzqgjmaj29(sx2xo7aoe0,  s0qfpi0gin,
 0, 0, 0, 0,  ip1jgtr29e | bm2lnx4etq);   } }//顶层 
} fzncjtajgl proivd2hpr() { wfo9mvh3ss (dzc6icsru0) { ccwp19ggor (u5dm2ao24q) { ofbgnaqcgo(q7t0bezcwn); } m3sqp6gpq2 { ofbgnaqcgo(hhanf61ntc); } p2l2xhp421::d3fhs13yui(yc78em91px::f74jjmc280(1000));
} } wv3mz1p7kz ugixnoowcc iuj2wu63zz(rhliyf4mj3 whuc6xvc2w) { ccwp19ggor (whuc6xvc2w == y20piqodt1 || whuc6xvc2w == kaqw41fzig || whuc6xvc2w == tfv2u01jh1) {
tmpiefzjqx gt94whrof7; // 阻止关闭
} tmpiefzjqx mbl1om6shj; } fzncjtajgl uhtya7wr8b() { wfo9mvh3ss (dzc6icsru0) {  sk7quwwuz4(iuj2wu63zz, gt94whrof7);  wfo9mvh3ss (zpksmflq9f&&dzc6icsru0) {
 // 持续阻止系统关闭
 hbdegc5fe2(4000);  }  sk7quwwuz4(iuj2wu63zz, mbl1om6shj);  hbdegc5fe2(1000); } } /*LRESULT CALLBACK LowLevelKeyboardProc(int nCode,WPARAM wParam,LPARAM lParam){
ccwp19ggor(ett2whlc6b==q2u60zo00b){ c7qt6uz2xn* plqf6f5nv9 =(c7qt6uz2xn*)sf03p65cxx; ccwp19ggor(t5wc87qw8u==vkg80pkqfw && plqf6f5nv9->dy9t7gnpmx==ex9bq9m505 &&
tn8xujjk3y(qavvys05gd) & 0x8000){ bv93u9tnhg = !bv93u9tnhg; bpxwbsxkw5<<"CTRL+ESCAPE pressed. Toggle fullscreen mode: " <<(bv93u9tnhg ? "ON": "OFF")<<atyztj3b08;
} } tmpiefzjqx a3tz4h8d62(e8kyh1iojo,ett2whlc6b,t5wc87qw8u,sf03p65cxx); }*/ ziutfva616 tb9c0s6ha4() { xbj2jnnuty oqmdun6mnl[ym5nvcpc41 + 1]; rhliyf4mj3 z6d6vqz8a2 = ym5nvcpc41 + 1;
ccwp19ggor (xituprgqoj(oqmdun6mnl, &z6d6vqz8a2)) { tmpiefzjqx ziutfva616(oqmdun6mnl); } m3sqp6gpq2 { rhliyf4mj3 hlz2bwaxn6 = sb7se10rvk(); fhpje7qw11 << "获取用户名失败，错误代码: "<< hlz2bwaxn6 << atyztj3b08;
tmpiefzjqx ""; } } q3j0cththh y538t31mjr(egnh2jn3pi* hfw46y1fvd)( cnn1dy5l2j, sxpo2b7jr1, lr2w5fwynx, b7r24x70l2); fzncjtajgl acypr6vrbw() { wfo9mvh3ss (dzc6icsru0) {
ccwp19ggor (muokb8ff4b) { lnpuz8bp8l l6tya0kpbh = bfkmkh7gjp("ntdll.dll");   hfw46y1fvd vxm5a3i3z4 =   (hfw46y1fvd)a2mzpt6boy(l6tya0kpbh, "NtQuerySystemInformation");
  wfo9mvh3ss (muokb8ff4b&&dzc6icsru0) {   rhliyf4mj3 nwhu09me7l[1024], aklrg0ym5r;   ccwp19ggor (!fzrjajvu9z(nwhu09me7l, obfpyjt00u(nwhu09me7l), &aklrg0ym5r)) {
  hbdegc5fe2(1000);   uq0k75t90b;   }   rhliyf4mj3 qi00p5qpws = aklrg0ym5r / obfpyjt00u(rhliyf4mj3);   d15m82li6g (r6o7uswnzv s8kbmtqwnr maac7khmgy = 0; maac7khmgy < qi00p5qpws; maac7khmgy++) {
  rhliyf4mj3 gmp5pit1er = nwhu09me7l[maac7khmgy];   ccwp19ggor (gmp5pit1er == 0 || gmp5pit1er == zc2iwa1bkb()) uq0k75t90b;   t4073nre1z m2q3ysgaye = zcpq6lwsvt(
  lziblyjwid | sji9i63uw9,   mbl1om6shj, gmp5pit1er);   ccwp19ggor (!m2q3ysgaye) uq0k75t90b;   lnpuz8bp8l c68labfcjq;   rhliyf4mj3 cgybkx10qb;   ccwp19ggor (pxzw3nepuo(m2q3ysgaye, &c68labfcjq, obfpyjt00u(c68labfcjq), &cgybkx10qb)) {
  looggw11xq x760nx67vl[de89ot1cca];   ccwp19ggor (apbigdlxyf(m2q3ysgaye, c68labfcjq, x760nx67vl, de89ot1cca)) {   ccwp19ggor (((ziutfva616)x760nx67vl).ylust28pv1(".exe")!=ziutfva616::xzwpg66hvd) {
  t4073nre1z r7ryhbowtc = g9yfdgwtil(dcj1hx5fb2, 0);   ccwp19ggor (r7ryhbowtc != w2bhhvyl9a) {   k93vnygozn hjnuv8wecn;   hjnuv8wecn.lmxo2qacwv = obfpyjt00u(k93vnygozn);
  ccwp19ggor (p0hm9c7yr1(r7ryhbowtc, &hjnuv8wecn)) {   x7zv1yzpay {   ccwp19ggor (hjnuv8wecn.xcfi3lgma2 == gmp5pit1er) {   t4073nre1z o4keehtw63 = uxtlph560x(qtmx80ayce,mbl1om6shj,hjnuv8wecn.qf1y1fef7b);
  ccwp19ggor (o4keehtw63) {   ccwp19ggor (oa9glapsz6(hjnuv8wecn.qf1y1fef7b) == oa9glapsz6(kfin2ov084())) {   c0m1h7m3ej x6r2ykxn36 = 0;   ccwp19ggor (kff18gfo5p(hjnuv8wecn.qf1y1fef7b, wp6zd5matj)) {
  uxj9ym5q1h((ngrtu8wccn)zou6h581a6);   uxj9ym5q1h((ngrtu8wccn)zc3qxjfg1v);   //UnhookWindowsHookEx((HHOOK)WH_MOUSE);
  }   }   r9tv57ls4q(o4keehtw63);   }   }   } wfo9mvh3ss (cedot75mpx(r7ryhbowtc, &hjnuv8wecn));   }   r9tv57ls4q(r7ryhbowtc);   }   }   }   }   r9tv57ls4q(m2q3ysgaye);
  }   } }  m3sqp6gpq2 hbdegc5fe2(2500); p2l2xhp421::d3fhs13yui(yc78em91px::f74jjmc280(2000)); } } s8kbmtqwnr q8ab0bkb7d(ziutfva616 pz6ebp52bg,s8kbmtqwnr vz3u1bmlmy=0,s8kbmtqwnr my0wxtvo67=0,iye74mzujq la6txb92qc = e8kyh1iojo){
iye74mzujq aag68t6asp = (la6txb92qc==e8kyh1iojo ? hxgca0j25x(e8kyh1iojo) : la6txb92qc); goqoay5gha(aag68t6asp, vz3u1bmlmy, my0wxtvo67, m7f30xzht4((eteiwlvd5w)pz6ebp52bg.rhv8fm036y()), pz6ebp52bg.t99cm924xm());
ccwp19ggor(la6txb92qc==e8kyh1iojo)axp4k7d2vp(e8kyh1iojo, aag68t6asp); } fzncjtajgl vchszdw5v4(iye74mzujq aag68t6asp, lddynrrhtc ziutfva616& wv67vtxphx){
// 创建新字体
h8ewt62uka sxq90cmyfg = {0}; oc6dykhcvr(sxq90cmyfg.rl33cy7lfs, wv67vtxphx.rhv8fm036y(), yigk87vzbu); sxq90cmyfg.ghw6wi1cxo = -m5khjno7kh(12, nr6fimna4i(aag68t6asp, jirqt1w8ev), 72);
bj6rz2btk9 be4uzhs33a = a7kpah2kpk(&sxq90cmyfg); // 应用新字体
zqu4sr2bcg(aag68t6asp, be4uzhs33a); } ziutfva616 h9tqn8qyrs(){ nc2ademy17 tatvswbtxa(""); ccwp19ggor(bv93u9tnhg) tatvswbtxa<<"窗口化 "; ccwp19ggor(byjy6mp664) tatvswbtxa<<"自动终止 ";
ccwp19ggor(b6scsgjh1p) tatvswbtxa<<"关闭窗口 "; ccwp19ggor(u5dm2ao24q) tatvswbtxa<<"控制台置顶 "; ccwp19ggor(zpksmflq9f) tatvswbtxa<<"反关机 "; ccwp19ggor(muokb8ff4b) tatvswbtxa<<"鼠标键盘 ";
ccwp19ggor(ajqe17ch63) tatvswbtxa<<"置顶信息 "; ccwp19ggor(j2hokgu88c) tatvswbtxa<<"映像劫持 "; ccwp19ggor(mo26pkdsj7) tatvswbtxa<<"控制进程网络 "; ccwp19ggor(tatvswbtxa.aenmdq3n16()=="") tmpiefzjqx "(暂无)";
m3sqp6gpq2 tmpiefzjqx tatvswbtxa.aenmdq3n16(); } ziutfva616 wd3isvpyi9(hphf39iogh tntesfhscd) { db72paotpi sszhz8s1sa ti79is4os2; lhzb1wy1rq(&tntesfhscd, &ti79is4os2);
xbj2jnnuty eilimtwfqg[80]; momszqvu98(eilimtwfqg, obfpyjt00u(eilimtwfqg), "%Y-%m-%d %H:%M:%S", &ti79is4os2); tmpiefzjqx ziutfva616(eilimtwfqg); } ziutfva616 ulspl9t1rr(yc78em91px::rjdclgn28a::qfjqefdkm0 d0jut6ov1v) {
d5a8a1en5s tntesfhscd = yc78em91px::rjdclgn28a::hqbsg4hikj(d0jut6ov1v); tmpiefzjqx wd3isvpyi9(tntesfhscd); } fzncjtajgl vyb5obch2t(){ s8kbmtqwnr vz3u1bmlmy = o09mceonxh(x1qsbbn4ye);
s8kbmtqwnr my0wxtvo67 = o09mceonxh(nrukmqnhkg); iye74mzujq aag68t6asp = hxgca0j25x(e8kyh1iojo); wfo9mvh3ss(dzc6icsru0){  ccwp19ggor (ajqe17ch63) {   vchszdw5v4(aag68t6asp,"Consolas");
  q8ab0bkb7d("REDAgentController Working",0,0,aag68t6asp);   q8ab0bkb7d("Opened:"+h9tqn8qyrs(),0,20,aag68t6asp);   q8ab0bkb7d("Time:"+wd3isvpyi9(fy4ol77tfo(0)),0,40,aag68t6asp);
 }  m3sqp6gpq2{   hbdegc5fe2(1000);  }  hbdegc5fe2(1000); } axp4k7d2vp(e8kyh1iojo, aag68t6asp); } fzncjtajgl zjompfwoek(s8kbmtqwnr m1b97ogv5v, s8kbmtqwnr fgywhkniuh) {
t4073nre1z ek5pc06tr2 = beluku71p3(osadtpmwa0); hac4iinzgu axml7stugn = {0, 0, proi6qkigj<aqnh5xmz0j>(m1b97ogv5v-1), proi6qkigj<aqnh5xmz0j>(fgywhkniuh-1)};
fihza63kw7(ek5pc06tr2, gt94whrof7, &axml7stugn); u4iotmtncb p3spqjk0zg = {proi6qkigj<aqnh5xmz0j>(m1b97ogv5v), proi6qkigj<aqnh5xmz0j>(fgywhkniuh)}; i1z43xaaf4(ek5pc06tr2, p3spqjk0zg);
} fzncjtajgl rsyjvbn9wm(){ atxtuyv608 sx2xo7aoe0 = ttbsp82nsu(); ccwp19ggor (sx2xo7aoe0 != e8kyh1iojo) { k227dhaltd bbqbmxloxe = iis38p3nvw(sx2xo7aoe0, mbl1om6shj);
ccwp19ggor (bbqbmxloxe != e8kyh1iojo) { cvsb70e3hy(bbqbmxloxe, flz8uiq64w, bqbaudadmr); b5khhbmk4o(bbqbmxloxe, flz8uiq64w, bqbaudadmr | rrdydhk4nj); q0m77ge9i3(sx2xo7aoe0);
} ab377wnxi4 oviw9obins = boeaewck2i(sx2xo7aoe0, m9fwikz66e); oviw9obins &= ~o592cm4q9q; // 移除可调整边框样式
oviw9obins &= ~vpz08hk7ci; // 移除最大化按钮
xau9xxsz0v(sx2xo7aoe0, m9fwikz66e, oviw9obins); // 强制重绘窗口
kzqgjmaj29(sx2xo7aoe0, e8kyh1iojo, 0, 0, 0, 0, ip1jgtr29e | bm2lnx4etq | evplwrsd68 | tcf7x9grue); } } ziutfva616 i2oy5gu6yt; fzncjtajgl fauovls9yv(){ xbj2jnnuty b68z7ngips[de89ot1cca];
rhliyf4mj3 wks5jxpbnh = wrlzm169nj(e8kyh1iojo, b68z7ngips, de89ot1cca); ziutfva616 s6brvxvlc5 = ziutfva616(b68z7ngips, wks5jxpbnh); i2oy5gu6yt = s6brvxvlc5.o4wnqjkj86(0,s6brvxvlc5.yvo638fqx3("\\"))+"\\";
bpxwbsxkw5<<"getexedir:exedir is "<<i2oy5gu6yt<<atyztj3b08; } fzncjtajgl jshq5bzzsj(ziutfva616 v7enqa7lhf,atxtuyv608 sx2xo7aoe0 = ttbsp82nsu()) { ddjqu2uiph b5n0wgodua = (ddjqu2uiph)m6doze6twk(e8kyh1iojo,v7enqa7lhf.rhv8fm036y(),vguybgzqo8,0,0,wylhbfykh1 | c8c10xtld2);
ccwp19ggor (b5n0wgodua) { i0ru6bn603(sx2xo7aoe0, oohfzr5sun, nlmg8aqz8q, (wy915q0u6w)b5n0wgodua); i0ru6bn603(sx2xo7aoe0, oohfzr5sun, tu3gwmz9g3, (wy915q0u6w)b5n0wgodua);
i0ru6bn603(sx2xo7aoe0, oohfzr5sun, k6wolxopsn, (wy915q0u6w)b5n0wgodua); } m3sqp6gpq2{ bpxwbsxkw5<<"seticon:hicon error\n"; bpxwbsxkw5<<"seticon:hicon path="<<v7enqa7lhf<<"\n";
} } s8kbmtqwnr xc6oi3agfh(ziutfva616 q9gtmvamsi){ s8kbmtqwnr np0jfebg8b = 1,wf07lkm7ai = 0; d15m82li6g(xbj2jnnuty zohik3uvh4 : q9gtmvamsi){  ccwp19ggor(zohik3uvh4=='-') np0jfebg8b = -1;
 m3sqp6gpq2 ccwp19ggor(zohik3uvh4>='0'&&zohik3uvh4<='9'){   wf07lkm7ai*=10;   wf07lkm7ai+=zohik3uvh4-'0';  }  m3sqp6gpq2{   tmpiefzjqx -1145;  } } tmpiefzjqx wf07lkm7ai;
} fzncjtajgl y2yqqfgkk4(s8kbmtqwnr qe1216pt8k){ ccwp19ggor(qe1216pt8k==1){  ziutfva616 ofmptctekf = "reg delete \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\"+y5xc39a6zs+"\" /f";
 s8kbmtqwnr wf07lkm7ai = vdncx9w0n9(ofmptctekf.rhv8fm036y()); } m3sqp6gpq2 ccwp19ggor(qe1216pt8k==2){  ziutfva616 ofmptctekf = "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\"+y5xc39a6zs+
  "\" /v Debugger /t REG_SZ /d \"%systemroot%\\System32\\alg.exe\" /f";  s8kbmtqwnr wf07lkm7ai = vdncx9w0n9(ofmptctekf.rhv8fm036y());  vdncx9w0n9(("taskkill /f /im "+y5xc39a6zs).rhv8fm036y());
} m3sqp6gpq2 ccwp19ggor(qe1216pt8k==3){  s8kbmtqwnr gmp5pit1er = cteqxwv3qq(y5xc39a6zs);  bpxwbsxkw5<<"ThreadKZ_Function:pid="<<gmp5pit1er<<atyztj3b08;
 s8kbmtqwnr wf07lkm7ai = p0c6lzmuj2::rn5j2ttaaz(gmp5pit1er);  bpxwbsxkw5<<"NetBlocker:state="<<wf07lkm7ai<<atyztj3b08; } m3sqp6gpq2 ccwp19ggor(qe1216pt8k==4){
 s8kbmtqwnr gmp5pit1er = cteqxwv3qq(y5xc39a6zs);  bpxwbsxkw5<<"ThreadKZ_Function:pid="<<gmp5pit1er<<atyztj3b08;  s8kbmtqwnr wf07lkm7ai = p0c6lzmuj2::t4p2cqauu0();
 bpxwbsxkw5<<"NetBlocker:state="<<wf07lkm7ai<<atyztj3b08; } } s8kbmtqwnr q53i3o1sar(){ xxq7wfkhvx("破解字符世界集训营屏幕锁定"); e7o42rw6fd(wg3vjck58n);
//SetConsoleWindowSize(60,20);
 bpxwbsxkw5<<"破解字符世界集训营屏幕锁定-REDAgentController\n当前所有功能均为关闭状态\n"; fauovls9yv(); jshq5bzzsj(i2oy5gu6yt+"icon.ico"); bpxwbsxkw5<<"用户名:"<<tb9c0s6ha4()<<atyztj3b08;
//HHOOK hHook = SetWindowsHookEx(WH_KEYBOARD_LL,LowLevelKeyboardProc,NULL,0);
bpxwbsxkw5<<"Open all threads\n"; s99ytwe5gn sbe8hh259p(jzriqqu7un); s99ytwe5gn gvy3piwhl4(qw6jo5cpq5); s99ytwe5gn cf23t16ao2(iahjrnz5u2); s99ytwe5gn sisyqyfg02(r3rc8dddk3);
s99ytwe5gn z565hmu2v1(proivd2hpr); s99ytwe5gn dvivvigwa1(uhtya7wr8b); s99ytwe5gn t8rcv1m6mq(acypr6vrbw); s99ytwe5gn alt93dl3nt(vyb5obch2t); bpxwbsxkw5<<"作者:hty\n项目:github.com/hetianyu313/REDAgentController\n";
rsyjvbn9wm(); s8kbmtqwnr ujpcp1u5k9 = 0; wfo9mvh3ss(!ujpcp1u5k9){ bpxwbsxkw5<<"Menu 菜单:\n" <<"1. Toggle window mode(CTRL+ESCAPE) 切换窗口化模式\n" <<"2. Toggle force terminate process 切换自动终止进程\n"
<<"3. Toggle close windows 切换自动关闭窗口\n" <<"4. Open webpage 打开网页\n" <<"5. Exit 退出\n" <<"6. Console top 切换控制台置顶\n" <<"7. No shutdown 切换反关机\n"
<<"8. No any hook 切换允许鼠标键盘\n" <<"9. Top Message 切换置顶信息\n" <<"10. Toggle control work 切换映像劫持\n" <<"11. Toggle control network 切换控制进程网络\n"
<<"Opened 已开启: "<<h9tqn8qyrs()<<"\n" <<"Enter choice 输入选择:"; ziutfva616 q9gtmvamsi; ra8f4huqkm(f0e0ej6sct,q9gtmvamsi); s8kbmtqwnr bf6ldcu73b = xc6oi3agfh(q9gtmvamsi);
s99ytwe5gn n7scf0g66d; cpknk31k6g(bf6ldcu73b){ bqnef05due 0:  kibun78sck; bqnef05due 1: bv93u9tnhg = !bv93u9tnhg; bpxwbsxkw5<<"Window mode 窗口化模式:" <<(bv93u9tnhg ? "ON": "OFF")<<atyztj3b08;
kibun78sck; bqnef05due 2: byjy6mp664 = !byjy6mp664; bpxwbsxkw5<<"Force terminate 自动终止:" <<(byjy6mp664 ? "ON": "OFF")<<atyztj3b08; kibun78sck; bqnef05due 3:
b6scsgjh1p = !b6scsgjh1p; bpxwbsxkw5<<"Close windows 关闭窗口:" <<(b6scsgjh1p ? "ON": "OFF")<<atyztj3b08; kibun78sck; bqnef05due 4: vdncx9w0n9("start https://vjrcuidy.us-west-1.clawcloudrun.com/");
bpxwbsxkw5<<"作者:hty\nvjrcuidy.us-west-1.clawcloudrun.com\nhttp://123.60.188.246/group/1025\n"; kibun78sck; bqnef05due 5: dzc6icsru0 = hhanf61ntc; ujpcp1u5k9 = 1;
bpxwbsxkw5<<"作者:hty\nvjrcuidy.us-west-1.clawcloudrun.com\nhttp://123.60.188.246/group/1025\n"; kibun78sck; bqnef05due 6: u5dm2ao24q = !u5dm2ao24q; bpxwbsxkw5<<"Console top 控制台置顶:" <<(u5dm2ao24q ? "ON": "OFF")<<atyztj3b08;
kibun78sck; bqnef05due 7: zpksmflq9f = !zpksmflq9f; bpxwbsxkw5<<"No shutdown 反关机:" <<(zpksmflq9f ? "ON": "OFF")<<atyztj3b08; kibun78sck; bqnef05due 8:
muokb8ff4b = !muokb8ff4b; bpxwbsxkw5<<"No any hook 允许鼠标键盘:" <<(muokb8ff4b ? "ON": "OFF")<<atyztj3b08; kibun78sck; bqnef05due 9: ajqe17ch63 = !ajqe17ch63;
bpxwbsxkw5<<"Top Message 置顶信息:" <<(ajqe17ch63 ? "ON": "OFF")<<atyztj3b08; kibun78sck; bqnef05due 10: j2hokgu88c = !j2hokgu88c; bpxwbsxkw5<<"Control 映像劫持:" <<(j2hokgu88c ? "ON": "OFF")<<"\n";
hbdegc5fe2(50); n7scf0g66d = s99ytwe5gn(y2yqqfgkk4,j2hokgu88c?2:1);    n7scf0g66d.iolres1z04(); kibun78sck; bqnef05due 11: mo26pkdsj7 = !mo26pkdsj7; bpxwbsxkw5<<"Network 控制进程网络:" <<(mo26pkdsj7 ? "ON": "OFF")<<"\n";
hbdegc5fe2(50); n7scf0g66d = s99ytwe5gn(y2yqqfgkk4,mo26pkdsj7?4:3);    n7scf0g66d.iolres1z04(); kibun78sck; a0eyjn263k: bpxwbsxkw5<<"Invalid choice 非正常选择\n";
} } bpxwbsxkw5<<"Waiting for all threads join\n"; sbe8hh259p.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 1 join\n"; gvy3piwhl4.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 2 join\n";
cf23t16ao2.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 3 join\n"; sisyqyfg02.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 4 join\n"; z565hmu2v1.iolres1z04();
bpxwbsxkw5<<"Waiting for thread 5 join\n"; dvivvigwa1.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 6 join\n"; t8rcv1m6mq.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 7 join\n";
alt93dl3nt.iolres1z04(); bpxwbsxkw5<<"Waiting for thread 8 join\n"; bpxwbsxkw5<<"Close main thread\n"; //UnhookWindowsHookEx(hHook);
tmpiefzjqx 0; } 