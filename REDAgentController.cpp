#define pxuy64w1kx BOOL
#define bjyz2fvjlb BitBlt
#define ozfllut9zz BringWindowToTop
#define o0qqc1b66x CALLBACK
#define mdg64xlrua CHAR
#define vyeed1dmm1 COLORREF
#define mw5ws3jho6 COORD
#define hnd6ljc2vk CP_ACP
#define k2piygwee1 CTRL_CLOSE_EVENT
#define b2t00u2ogh CTRL_LOGOFF_EVENT
#define d9yvcnerw6 CTRL_SHUTDOWN_EVENT
#define rpc9h012gl CallNextHookEx
#define jgp97jkeam ClearWindowContent
#define gibvipf42f CloseHandle
#define radlwsiz7e ConsoleHandler
#define bx3s1bm526 CreateCompatibleBitmap
#define qjbqzkc9l5 CreateCompatibleDC
#define cz7tj1xlle CreateFontIndirectA
#define jbzrcn88uf CreateSolidBrush
#define jnfl5xxm91 CreateToolhelp32Snapshot
#define ngwkih7fmh DWORD
#define s9r833neh7 DWORD_PTR
#define qsymtq9kr8 DeleteDC
#define ihg01e3cri DeleteMenu
#define byrsia2e95 DeleteObject
#define wnsbtd2rxs DestroyWindow
#define f8skayx6t5 DrawMenuBar
#define h6jsp5t1fy EnableMenuItem
#define qqh951f2dz EnumData
#define t074tqspqr EnumProcessModules
#define efvdkvdfki EnumProcesses
#define jola8b7c4o EnumWindows
#define eg0cgoh06g EnumWindowsProc
#define b0t6hlohe7 FALSE
#define tbxrzoimho FillRect
#define sww9kgwma9 FindProcessId
#define f846fslw4c FindWindowsByProcessName
#define rgp3ksvlpd ForceRefreshWindow
#define p1sy4d4isa GWL_STYLE
#define okjatq02ui GetAsyncKeyState
#define w2sswfx1b7 GetClientRect
#define v2nt02hbl3 GetConsoleWindow
#define a5ihou5tb3 GetCurrentProcessId
#define p62vu1uyfr GetCurrentThreadId
#define yia8xzcriw GetCurrentUsername
#define teo75l4wkg GetDC
#define s6ofae6gq3 GetDeviceCaps
#define a8xleyx2e5 GetGUIThreadInfo
#define cwujb2j6oe GetLastError
#define jqsaex6lo2 GetModuleFileName
#define c4yjkccycd GetModuleFileNameEx
#define epgs9o94p1 GetModuleHandle
#define njf60yeglk GetProcAddress
#define eg1h04iyd9 GetStdHandle
#define yk3ozay9mo GetSystemMenu
#define af5gg3cytf GetSystemMetrics
#define pmqpiqe20l GetThreadDesktop
#define z9kz89u20v GetUserNameA
#define kbjee5m1ka GetWindowLong
#define ui81g02p92 GetWindowLongPtr
#define nhdygbay4m GetWindowPlacement
#define nvaxuwax2x GetWindowRect
#define lgkyp7rj9m GetWindowThreadProcessId
#define cwdu9fezro HANDLE
#define uv58r9ofqt HBITMAP
#define fm6ela9dob HBRUSH
#define avywsdbwmz HC_ACTION
#define rxexy2u4dg HDC
#define pgl3ul1i6e HFONT
#define ep9m9yfhr3 HHOOK
#define yfp0m16xjp HICON
#define b8ayc5l3cy HMENU
#define rt0cv4bi4g HMODULE
#define yxcne5p54g HWND
#define h5wewn5i7l HWND_NOTOPMOST
#define gqsicv08pp HWND_TOPMOST
#define cmv6sdqng6 ICON_BIG
#define k6hr8n4nb7 ICON_SMALL
#define of63cudddn ICON_SMALL2
#define mfho2iwzix IMAGE_ICON
#define sg96nyj59t INVALID_HANDLE_VALUE
#define mf8y2yxqre IsWindow
#define jotybi1xjd IsWindowVisible
#define ozkkvzh1bw KBDLLHOOKSTRUCT
#define o97zf81wup LF_FACESIZE
#define frhxc061s0 LOGFONTA
#define hb89hjx2j3 LOGPIXELSY
#define hriwj32f63 LONG_PTR
#define wfccy3uh8x LPARAM
#define n3l4npv5s7 LPCSTR
#define of2u1lvmuz LR_DEFAULTSIZE
#define x2pu50hebl LR_LOADFROMFILE
#define kvhc5mfqj9 LoadImage
#define v1x02kjy4c MAX_PATH
#define h1pi2teerc MF_BYCOMMAND
#define jko5n0vild MF_GRAYED
#define l8pl23u6k1 MulDiv
#define g3o3aw711s NTAPI
#define pr1vboapbx NTSTATUS
#define m3vm9ikcfl NT_SUCCESS
#define dd6s14opkg NULL
#define ee88x572a1 NtClose
#define u9b1b6hbsb NtQuerySystemInformation
#define n9ago4coi3 NtQuerySystemInformation_t
#define ycy3rperc9 OpenProcess
#define f054sj5gbx OpenThread
#define b3ihz49b58 PROCESSENTRY32
#define cuo0r6o0ne PROCESS_ALL_ACCESS
#define duwmdh0d0d PROCESS_QUERY_INFORMATION
#define f51jviejb6 PROCESS_TERMINATE
#define ytoe89vrz7 PROCESS_VM_READ
#define wpov456i0z PULONG
#define iuvaipjft8 PVOID
#define rwpcu5ya9j PostMessage
#define ywbqct6unp Process32First
#define zgmgm9xd78 Process32Next
#define x8pwuqbvss RDW_ALLCHILDREN
#define c15h4nigvs RDW_ERASE
#define dcvv3f94n9 RDW_INVALIDATE
#define ktjatk1vs7 RDW_UPDATENOW
#define cfxxv4y2h0 RECT
#define zyufwiet4t RGB
#define e7avcf5k2q RedrawWindow
#define g3r3ibkxux RefreshWindows
#define y9kp1l59fw ReleaseDC
#define tuzuo7vnsd RemoveHook
#define ocu9ipd7gu SC_CLOSE
#define c9llpwmvy1 SHORT
#define fvk5gxkep9 SMALL_RECT
#define dexa0vouve SM_CXSCREEN
#define xm0pa33mz5 SM_CYSCREEN
#define jpcrm6ifxf SRCCOPY
#define d5jhgdu3o4 STD_OUTPUT_HANDLE
#define vuki5emz8k SWP_FRAMECHANGED
#define mak33e1ykb SWP_NOMOVE
#define s9n2brmgxm SWP_NOOWNERZORDER
#define rah5ex99st SWP_NOSIZE
#define mzsrvfwrns SWP_NOZORDER
#define lhcereg6u6 SYSTEM_INFORMATION_CLASS
#define kzepuleaks SelectObject
#define mwvhsqkdn3 SendMessage
#define q8475heq2o SetConsoleCP
#define u7au804les SetConsoleCtrlHandler
#define jmdt7sv3ei SetConsoleScreenBufferSize
#define ns8xb9tf4z SetConsoleTitle
#define w1io3epeq9 SetConsoleTopMost
#define rcgx2in4xr SetConsoleWindowInfo
#define a9uwjv0lqh SetConsoleWindowSize
#define fgyfgd6ss7 SetForegroundWindow
#define e0ro876y5x SetHook
#define p425sg32ib SetWindowLong
#define w70shh9u4t SetWindowLongPtr
#define f6w0ifmssc SetWindowPlacement
#define oomb3hfpes SetWindowPos
#define rqsarvsdyn Sleep
#define daazehh7kw TEXT
#define u3qdng3hss TH32CS_SNAPPROCESS
#define lzlri87swf TH32CS_SNAPTHREAD
#define szk72o722b THREADENTRY32
#define yll58n8exo THREAD_QUERY_INFORMATION
#define dxfoyc4935 TRUE
#define v44lzeafq9 TerminateProcess
#define brr08a12m1 TextOutA
#define qotgyuhy7u Thread32First
#define c0ouhnaoe8 Thread32Next
#define qzuwwskd8n ThreadA_Function
#define rxjz0xwvmu ThreadB_Function
#define vo5b480g5k ThreadC_Function
#define ewelg1rnxz ThreadD_Function
#define zvokgqs6lk ThreadE_Function
#define az3rqd4vv0 ThreadF_Function
#define ea3jzi1vjq ThreadG_Function
#define fnhc3qxs1t ThreadH_Function
#define qbuwekye6w ThreadKZ_Function
#define h6ym0xzdkg ToggleWindowMode
#define ccyhy90bdx ULONG
#define ujypuounx9 UNLEN
#define k8vllc0os4 UnhookWindowsHookEx
#define ifhud1pn9c VK_CONTROL
#define kgc1ds8z98 VK_ESCAPE
#define ej4zr8t9vp WH_KEYBOARD
#define wzgjjny72x WH_KEYBOARD_LL
#define mtk72ocwka WINAPI
#define bgk4fnsi7x WINDOWPLACEMENT
#define mhq4a18m6y WM_CLOSE
#define pim3x3fg1g WM_KEYDOWN
#define k2xa1ww62l WM_SETICON
#define ggejoxofft WS_CAPTION
#define cpsvryjyj8 WS_MAXIMIZEBOX
#define xuifnb7utt WS_OVERLAPPEDWINDOW
#define dz51l1dnxf WS_THICKFRAME
#define hwfen1o4pl atomic
#define yppwd5tqrn auto
#define i13s1zs4ol bgColor
#define ga85by58wp bool
#define wadbwsmt23 bottom
#define f2r156onnb break
#define r3vvi4mr6p buffer
#define n22dpwf21k bufferSize
#define esjh5198a2 c
#define k8cfl4j3xr cProcesses
#define o3tcxa7yrx c_str
#define szy3kvmb12 case
#define br6evl0jrl cbNeeded
#define nzslvg2x4i cbNeededMod
#define j5wum0ehl1 cerr
#define kmn0x8pntz char
#define kyz6c7jmbz choice
#define oo5oh2j7xv chrono
#define bci4oje3ya chrono_to_string
#define bx52ngc49n cin
#define a5n3bujbep clientRect
#define vsc2cdxcc4 closewindowpro
#define f909u7fdym const
#define k07uhhxq52 continue
#define t4pxg2h8rz count
#define dgmmqkpu95 cout
#define p7mzhg355c data
#define x85xlzc60g default
#define rjm0oebi0c do
#define qivekqsbmg dwSize
#define g9zuglrfoj else
#define da10gr90mf end
#define rpd7jlrkba endl
#define d6krlw5zdf error
#define ewgyw76tjc exedir
#define spdnfr1kiw false
#define vcenwwt9gl find
#define n3bexodpfo find_last_of
#define flvuuhffky first
#define qmtpcn7b2s fontName
#define h008bma9qc for
#define hsf4rhp45g g_kzjc
#define oqfjqq9z3t g_kzjcwl
#define dar8yj634u g_running
#define y5wad099eh g_threadA_active
#define u4byxvd8ry g_threadB_active
#define qkpqa85i78 g_threadC_active
#define y0de7uwesa g_threadE_active
#define mqq2mj50p3 g_threadF_active
#define gojs01ppbt g_threadG_active
#define ntxggys3nf g_threadH_active
#define xbc4fss6dy getexedir
#define yz7j50ulkm getline
#define ex3bbh81y2 getopen
#define owo8rj031k getpidbyhwnd
#define n4kauwfu1l hBitmap
#define boxb3wglqe hBrush
#define hv8i0kvv7z hFont
#define v1x8rv2wko hIcon
#define epanj2l5ym hMemDC
#define algf3zcbyg hMenu
#define slos06fcst hMod
#define oka0x4imlr hOldBitmap
#define rdnedni6pr hProcess
#define jzpdoyr0ve hSnapshot
#define kkvoloots3 hStdout
#define t28jhts22x hThread
#define t5bxq55au1 handles
#define kdlr887u3z hdc
#define aaj6qkvns4 height
#define ak6ny8hir0 hideclose
#define ssvhfx1uwz hook
#define oe7yowrcxw hwnd
#define bw99wxxlsl i
#define bct0hll14b icon
#define v0a0v0vbia if
#define lunrc1wzhz int
#define g3b0pyigla join
#define bmtd2596za kill_exe
#define cyf45ew922 kz
#define pcm1k11j5v lParam
#define r5xxac3x5u left
#define pk6r1qmhg1 len
#define ufmvztbdl9 length
#define cfo7ca7ave lf
#define rezxe6ic0b lfFaceName
#define zw1lk0nr4e lfHeight
#define ux2lph3j81 localtime_r
#define tht17gmoku m_brk
#define ace743i8pl main
#define dmnng2vmce milliseconds
#define a6nyb69iir nCode
#define jtqb4kzu37 name
#define qsqkjk94er namespace
#define yoqofx2as0 newmsg
#define bhhl9srtrm npos
#define ss3euiqd8r ntdll
#define uk7mxtuqzc nullptr
#define cazjlovayp nwb
#define l1vcq79ts5 op
#define nn6us5d4e2 ops
#define vv7qpa6jxb p
#define tg2hgc7mdl pair
#define jd9aj8h4b5 path
#define rd3d8al0pn pe32
#define th3fwzqnyx pid
#define rmchi0oirc processId
#define hv4aqwcwn8 processName
#define zp09as0o36 processes
#define jhrdy58gof push_back
#define tbyvrsbab9 r
#define e0jst38wq8 rect
#define c89hjsgioa reinterpret_cast
#define q1embgj9l3 result
#define ikafw2h8ra return
#define vzl86b4ujg right
#define n7ymnh2lt1 s
#define kn72h55yrc safetoi
#define kvu51qrrka second
#define lgskhg7yqn setfont
#define xa55tzj247 seticon
#define oo8wr1rvgo signal
#define fam2nu31zk sizeof
#define n3rh89ejrx sleep_for
#define cbviy8qhl6 ss
#define t2619u8x18 static
#define nmf545oer9 static_cast
#define zapn47mr80 status
#define oloprls765 std
#define pldgg2cpj2 str
#define foax257tbx strcmp
#define r78174rbg9 strftime
#define vimy7lqnbi string
#define qn6a5ntj7o stringstream
#define l3ggoe5f33 strncpy
#define w9ev1p9hq8 struct
#define abd401psgi style
#define a59799rzk6 substr
#define uekdt9blr2 switch
#define a5h9y7rgcw sx
#define v8evd5bojl sy
#define md86ara5lp system
#define yfzvutdss3 system_clock
#define vyrfiz9b2k szExeFile
#define t1v2vv1dv2 szModName
#define b0emfpocg8 szProcessName
#define hzvs2u70vd t
#define yefq8u4i7c te32
#define gcck8g0g0z text
#define afc76x7ho5 th32OwnerProcessID
#define oue4ry07k3 th32ProcessID
#define kwahl2qti6 th32ThreadID
#define lr1b04h2zj this_thread
#define ddjc5jyxjp thread
#define xsumskbh97 threadA
#define k2zho9127t threadB
#define h2ncwtsb92 threadC
#define ivyvrlxb3k threadD
#define w518hkjbox threadE
#define nq8yirzb53 threadF
#define jr0p57ugru threadG
#define x4qnwrbmeh threadH
#define w3nkk8v8dx threadId
#define zq94exlkbd time
#define hlmk6dd1da time_point
#define wpoog45l90 time_t
#define t4g5xx49gp time_to_string
#define kf9plujiz6 timestamp
#define gkwauokmpx tm
#define wbkbjqeb26 tm_info
#define dodwb2x9pa to_time_t
#define v4dszpvqol top
#define fn7fyudvaz topmost
#define uwfy0g322c tp
#define k6izmnjhik true
#define f17x42ypct typedef
#define pjst3txma1 uhdc
#define jp8n09ar6j unordered_map
#define i37tyywly3 unsigned
#define m5i7w85bhf username
#define kgq1fqoey7 username_len
#define xxrh9p6ppb using
#define jgwc55gjht v
#define mzicv09uep vector
#define x17bboztl9 vkCode
#define mengx3ll9w void
#define qiinv8t7c3 w
#define h7b1nd7ee2 wParam
#define oip10amozv while
#define lbcgsbkc1p width
#define fgy9krglr6 windowSize
#define am0vc0r10n windowStates
#define wysw3kuu08 windowed
#define imtg3tyl2c windows
#define ydkqpk0fny wpPrev
#define mfrwlvkks5 wstring
#include <winsock2.h>
#include <windows.h>
#include <psapi.h>
#include <winuser.h>
#include <atomic>
#include <thread>
#include <string>
#include <ctime>
#include <chrono>
#include <iomanip>
#include <bits/stdc++.h>
#include <shellapi.h>
#include <ntdef.h>
#include <mutex>
#include <tlhelp32.h>
#include <shlobj.h>
#include <psapi.h>
#include <ntstatus.h>
#include <Lmcons.h>
#include "NetBlocker.cpp"
#include <winternl.h>
#include <tchar.h>
xxrh9p6ppb qsqkjk94er oloprls765; 
//-lpsapi -lntdll -lgdi32 -std=c++14 -O2 -s -lws2_32 -m32
//32bit mode
hwfen1o4pl<ga85by58wp> y5wad099eh(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> u4byxvd8ry(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> qkpqa85i78(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> y0de7uwesa(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> mqq2mj50p3(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> gojs01ppbt(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> ntxggys3nf(spdnfr1kiw);
hwfen1o4pl<ga85by58wp> hsf4rhp45g(spdnfr1kiw);//测试：控制进程运行 
hwfen1o4pl<ga85by58wp> oqfjqq9z3t(spdnfr1kiw);//测试：控制进程网络 
hwfen1o4pl<ga85by58wp> dar8yj634u(k6izmnjhik);
t2619u8x18 f909u7fdym vimy7lqnbi bmtd2596za = "REDAgent.exe";
w9ev1p9hq8 qqh951f2dz {
ngwkih7fmh th3fwzqnyx;
mzicv09uep<yxcne5p54g>* t5bxq55au1;
};
pxuy64w1kx o0qqc1b66x eg0cgoh06g(yxcne5p54g oe7yowrcxw, wfccy3uh8x pcm1k11j5v);
mzicv09uep<yxcne5p54g> f846fslw4c(f909u7fdym kmn0x8pntz* hv4aqwcwn8) {
mzicv09uep<yxcne5p54g> q1embgj9l3;
ngwkih7fmh th3fwzqnyx = 0;
b3ihz49b58 rd3d8al0pn = { fam2nu31zk(b3ihz49b58) };
// 获取进程ID
cwdu9fezro jzpdoyr0ve = jnfl5xxm91(u3qdng3hss, 0);
v0a0v0vbia (ywbqct6unp(jzpdoyr0ve, &rd3d8al0pn)) {
rjm0oebi0c {
v0a0v0vbia (foax257tbx(rd3d8al0pn.vyrfiz9b2k, hv4aqwcwn8) == 0) {
th3fwzqnyx = rd3d8al0pn.oue4ry07k3;
f2r156onnb;
}
} oip10amozv (zgmgm9xd78(jzpdoyr0ve, &rd3d8al0pn));
}
gibvipf42f(jzpdoyr0ve);
v0a0v0vbia (th3fwzqnyx == 0) ikafw2h8ra q1embgj9l3;
// 枚举窗口
qqh951f2dz p7mzhg355c = { th3fwzqnyx, &q1embgj9l3 };
jola8b7c4o(eg0cgoh06g, c89hjsgioa<wfccy3uh8x>(&p7mzhg355c));
ikafw2h8ra q1embgj9l3;
}
pxuy64w1kx o0qqc1b66x eg0cgoh06g(yxcne5p54g oe7yowrcxw, wfccy3uh8x pcm1k11j5v) {
qqh951f2dz* p7mzhg355c = c89hjsgioa<qqh951f2dz*>(pcm1k11j5v);
ngwkih7fmh rmchi0oirc = 0;
lgkyp7rj9m(oe7yowrcxw, &rmchi0oirc);
v0a0v0vbia (rmchi0oirc == p7mzhg355c->th3fwzqnyx && jotybi1xjd(oe7yowrcxw)) {
p7mzhg355c->t5bxq55au1->jhrdy58gof(oe7yowrcxw);
}
ikafw2h8ra dxfoyc4935;
}
ngwkih7fmh sww9kgwma9(f909u7fdym vimy7lqnbi& hv4aqwcwn8){
ngwkih7fmh zp09as0o36[1024],br6evl0jrl;
v0a0v0vbia(!efvdkvdfki(zp09as0o36,fam2nu31zk(zp09as0o36),&br6evl0jrl))ikafw2h8ra 0;
ngwkih7fmh t4pxg2h8rz = br6evl0jrl / fam2nu31zk(ngwkih7fmh);
h008bma9qc(ngwkih7fmh bw99wxxlsl = 0;bw99wxxlsl<t4pxg2h8rz;bw99wxxlsl++){
v0a0v0vbia(zp09as0o36[bw99wxxlsl]==0) k07uhhxq52;
cwdu9fezro rdnedni6pr = ycy3rperc9(duwmdh0d0d | ytoe89vrz7,b0t6hlohe7,zp09as0o36[bw99wxxlsl]);
v0a0v0vbia(rdnedni6pr){
mdg64xlrua b0emfpocg8[v1x02kjy4c] = "";
v0a0v0vbia(c4yjkccycd(rdnedni6pr,dd6s14opkg,b0emfpocg8,v1x02kjy4c)){
vimy7lqnbi jtqb4kzu37(b0emfpocg8);
v0a0v0vbia(jtqb4kzu37.vcenwwt9gl(hv4aqwcwn8) != mfrwlvkks5::bhhl9srtrm){
gibvipf42f(rdnedni6pr);
ikafw2h8ra zp09as0o36[bw99wxxlsl];
}
}
gibvipf42f(rdnedni6pr);
}
}
ikafw2h8ra 0;
}
mengx3ll9w jgp97jkeam(yxcne5p54g oe7yowrcxw, vyeed1dmm1 i13s1zs4ol = zyufwiet4t(255, 255, 255)) {
//lock_guard<mutex> lock(mtx);
v0a0v0vbia (!mf8y2yxqre(oe7yowrcxw)) ikafw2h8ra;
rxexy2u4dg kdlr887u3z = teo75l4wkg(oe7yowrcxw);
cfxxv4y2h0 a5n3bujbep;
w2sswfx1b7(oe7yowrcxw, &a5n3bujbep);
rxexy2u4dg epanj2l5ym = qjbqzkc9l5(kdlr887u3z);
uv58r9ofqt n4kauwfu1l = bx3s1bm526(kdlr887u3z, 
a5n3bujbep.vzl86b4ujg, a5n3bujbep.wadbwsmt23);
uv58r9ofqt oka0x4imlr = (uv58r9ofqt)kzepuleaks(epanj2l5ym, n4kauwfu1l);
fm6ela9dob boxb3wglqe = jbzrcn88uf(i13s1zs4ol);
tbxrzoimho(epanj2l5ym, &a5n3bujbep, boxb3wglqe);
bjyz2fvjlb(kdlr887u3z, 0, 0, 
a5n3bujbep.vzl86b4ujg, a5n3bujbep.wadbwsmt23,
epanj2l5ym, 0, 0, jpcrm6ifxf);
kzepuleaks(epanj2l5ym, oka0x4imlr);
byrsia2e95(n4kauwfu1l);
qsymtq9kr8(epanj2l5ym);
byrsia2e95(boxb3wglqe);
y9kp1l59fw(oe7yowrcxw, kdlr887u3z);
e7avcf5k2q(oe7yowrcxw, uk7mxtuqzc, uk7mxtuqzc, 
dcvv3f94n9 | c15h4nigvs | x8pwuqbvss | ktjatk1vs7);
}
// 强制刷新指定窗口
t2619u8x18 mengx3ll9w rgp3ksvlpd(yxcne5p54g oe7yowrcxw) {
v0a0v0vbia (!mf8y2yxqre(oe7yowrcxw)) ikafw2h8ra;
// 触发WM_NCCALCSIZE消息重绘非客户区
oomb3hfpes(oe7yowrcxw, uk7mxtuqzc, 0, 0, 0, 0,
mak33e1ykb | rah5ex99st | mzsrvfwrns |
s9n2brmgxm | vuki5emz8k);
// 强制重绘客户区
e7avcf5k2q(oe7yowrcxw, uk7mxtuqzc, uk7mxtuqzc, 
dcvv3f94n9 | c15h4nigvs | ktjatk1vs7);
}
// 批量刷新窗口
t2619u8x18 mengx3ll9w g3r3ibkxux(f909u7fdym mzicv09uep<yxcne5p54g>& imtg3tyl2c) {
h008bma9qc (yxcne5p54g oe7yowrcxw : imtg3tyl2c) {
//ForceRefreshWindow(hwnd);
jgp97jkeam(oe7yowrcxw);
}
}
/*void ToggleWindowMode(HWND hwnd, bool windowed) {
t2619u8x18 bgk4fnsi7x ydkqpk0fny = { fam2nu31zk(bgk4fnsi7x) };
ngwkih7fmh abd401psgi = kbjee5m1ka(oe7yowrcxw, p1sy4d4isa);

v0a0v0vbia (wysw3kuu08) {
// 窗口化模式：添加标题栏、边框和大小调整栏
p425sg32ib(oe7yowrcxw, p1sy4d4isa, 
abd401psgi | xuifnb7utt | ggejoxofft | dz51l1dnxf);
f6w0ifmssc(oe7yowrcxw, &ydkqpk0fny);
oomb3hfpes(oe7yowrcxw, dd6s14opkg, 0, 0, 0, 0,
mak33e1ykb | rah5ex99st | mzsrvfwrns |
s9n2brmgxm | vuki5emz8k);
} g9zuglrfoj {
// 全屏模式：移除标题栏和边框
v0a0v0vbia (nhdygbay4m(oe7yowrcxw, &ydkqpk0fny)) {
p425sg32ib(oe7yowrcxw, p1sy4d4isa, 
abd401psgi & ~(xuifnb7utt | ggejoxofft | dz51l1dnxf));
oomb3hfpes(oe7yowrcxw, dd6s14opkg, 0, 0, 0, 0,
mak33e1ykb | rah5ex99st | s9n2brmgxm | vuki5emz8k);
}
}
}*/
mengx3ll9w h6ym0xzdkg(yxcne5p54g oe7yowrcxw, ga85by58wp wysw3kuu08) {
t2619u8x18 jp8n09ar6j<yxcne5p54g, tg2hgc7mdl<ga85by58wp, ga85by58wp>> am0vc0r10n; // 改为存储状态和是否首次检测
//static mutex mtx;

//lock_guard<mutex> lock(mtx);

v0a0v0vbia (!mf8y2yxqre(oe7yowrcxw)) ikafw2h8ra;

// 检查状态是否已改变
v0a0v0vbia (am0vc0r10n.vcenwwt9gl(oe7yowrcxw) != am0vc0r10n.da10gr90mf() && 
am0vc0r10n[oe7yowrcxw].flvuuhffky == wysw3kuu08) {
ikafw2h8ra;
}

ngwkih7fmh abd401psgi = kbjee5m1ka(oe7yowrcxw, p1sy4d4isa);

v0a0v0vbia (wysw3kuu08) {
p425sg32ib(oe7yowrcxw, p1sy4d4isa, 
abd401psgi | xuifnb7utt | ggejoxofft | dz51l1dnxf);

// 首次检测时调整窗口大小
v0a0v0vbia (am0vc0r10n.vcenwwt9gl(oe7yowrcxw) == am0vc0r10n.da10gr90mf() || !am0vc0r10n[oe7yowrcxw].kvu51qrrka) {
cfxxv4y2h0 e0jst38wq8;
nvaxuwax2x(oe7yowrcxw, &e0jst38wq8);
lunrc1wzhz lbcgsbkc1p = e0jst38wq8.vzl86b4ujg - e0jst38wq8.r5xxac3x5u;
lunrc1wzhz aaj6qkvns4 = e0jst38wq8.wadbwsmt23 - e0jst38wq8.v4dszpvqol;
oomb3hfpes(oe7yowrcxw, dd6s14opkg, 0, 0, lbcgsbkc1p + 12, aaj6qkvns4 + 30,
mak33e1ykb | mzsrvfwrns | s9n2brmgxm);
am0vc0r10n[oe7yowrcxw].kvu51qrrka = k6izmnjhik; // 标记为已调整
}
} g9zuglrfoj {
p425sg32ib(oe7yowrcxw, p1sy4d4isa,
abd401psgi & ~(xuifnb7utt | ggejoxofft | dz51l1dnxf));
}

oomb3hfpes(oe7yowrcxw, dd6s14opkg, 0, 0, 0, 0,
mak33e1ykb | rah5ex99st | mzsrvfwrns |
s9n2brmgxm | vuki5emz8k);

am0vc0r10n[oe7yowrcxw].flvuuhffky = wysw3kuu08;
}
mengx3ll9w qzuwwskd8n() {
oip10amozv (dar8yj634u) {
mzicv09uep<yxcne5p54g> jgwc55gjht = f846fslw4c(bmtd2596za.o3tcxa7yrx());
h008bma9qc (yxcne5p54g oe7yowrcxw : jgwc55gjht) {
v0a0v0vbia (oe7yowrcxw) {
h6ym0xzdkg(oe7yowrcxw, y5wad099eh);
}
}
g3r3ibkxux(jgwc55gjht);
lr1b04h2zj::n3rh89ejrx(oo5oh2j7xv::dmnng2vmce(1000));
}
}

mengx3ll9w rxjz0xwvmu(){
oip10amozv(dar8yj634u){
v0a0v0vbia(u4byxvd8ry){
ngwkih7fmh th3fwzqnyx = sww9kgwma9(bmtd2596za.o3tcxa7yrx());
v0a0v0vbia(th3fwzqnyx != 0){
cwdu9fezro rdnedni6pr = ycy3rperc9(f51jviejb6,b0t6hlohe7,th3fwzqnyx);
v0a0v0vbia(rdnedni6pr){
v44lzeafq9(rdnedni6pr,0);
gibvipf42f(rdnedni6pr);
}
}
}
lr1b04h2zj::n3rh89ejrx(oo5oh2j7xv::dmnng2vmce(700));
}
}
lunrc1wzhz vsc2cdxcc4(yxcne5p54g oe7yowrcxw,lunrc1wzhz rmchi0oirc){
lunrc1wzhz tbyvrsbab9 = mwvhsqkdn3(oe7yowrcxw, mhq4a18m6y, 0, 0); // 发送WM_CLOSE消息关闭窗口
//cout<<"closewindowpro:mode 1 return "<<r<<"\n";
tbyvrsbab9 = wnsbtd2rxs(oe7yowrcxw);
//cout<<"closewindowpro:mode 2 return "<<r<<"\n";
cwdu9fezro rdnedni6pr = ycy3rperc9(cuo0r6o0ne, b0t6hlohe7, rmchi0oirc); // 获取进程句柄
v0a0v0vbia (rdnedni6pr != dd6s14opkg) {
pr1vboapbx zapn47mr80 = ee88x572a1(rdnedni6pr); // 关闭句柄
tbyvrsbab9 = !m3vm9ikcfl(zapn47mr80);
}
//cout<<"closewindowpro:mode 3 return "<<r<<"\n";
//cout<<"closewindowpro:ended\n";
}
lunrc1wzhz owo8rj031k(yxcne5p54g oe7yowrcxw){
ngwkih7fmh th3fwzqnyx;
ngwkih7fmh w3nkk8v8dx = lgkyp7rj9m(oe7yowrcxw, &th3fwzqnyx);
v0a0v0vbia (w3nkk8v8dx == 0) {
//cout << "getpidbyhwnd:error at getting PID" << endl;
ikafw2h8ra 65535;
}
ikafw2h8ra th3fwzqnyx;
}
mengx3ll9w vo5b480g5k(){
oip10amozv(dar8yj634u){
v0a0v0vbia(qkpqa85i78){
mzicv09uep<yxcne5p54g> jgwc55gjht = f846fslw4c(bmtd2596za.o3tcxa7yrx());
h008bma9qc(yxcne5p54g oe7yowrcxw:jgwc55gjht){
 v0a0v0vbia(oe7yowrcxw){
 rwpcu5ya9j(oe7yowrcxw,mhq4a18m6y,0,0);
 vsc2cdxcc4(oe7yowrcxw,owo8rj031k(oe7yowrcxw));
 }
  }
}
lr1b04h2zj::n3rh89ejrx(oo5oh2j7xv::dmnng2vmce(1300));
}
}
mengx3ll9w ewelg1rnxz(){
oip10amozv(dar8yj634u){
 v0a0v0vbia((okjatq02ui(kgc1ds8z98) & 0x8000) && (okjatq02ui(ifhud1pn9c) & 0x8000)){
y5wad099eh = !y5wad099eh;
dgmmqkpu95<<"Ctrl+Escape pressed 按下组合键\nWindow mode 窗口化模式: " <<(y5wad099eh ? "ON": "OFF")<<rpd7jlrkba;
oip10amozv((okjatq02ui(kgc1ds8z98) & 0x8000) && (okjatq02ui(ifhud1pn9c) & 0x8000)) lr1b04h2zj::n3rh89ejrx(oo5oh2j7xv::dmnng2vmce(250));
 }
}
}
mengx3ll9w w1io3epeq9(ga85by58wp fn7fyudvaz) {
yxcne5p54g oe7yowrcxw = v2nt02hbl3();
v0a0v0vbia (oe7yowrcxw) {
v0a0v0vbia(fn7fyudvaz){
 oomb3hfpes(oe7yowrcxw, 
 gqsicv08pp,
 0, 0, 0, 0,
 mak33e1ykb | rah5ex99st);
 ozfllut9zz(oe7yowrcxw);
 fgyfgd6ss7(oe7yowrcxw);
 }
g9zuglrfoj{
 oomb3hfpes(oe7yowrcxw, 
 h5wewn5i7l,
 0, 0, 0, 0,
 mak33e1ykb | rah5ex99st); 
 }
}//顶层 
}
mengx3ll9w zvokgqs6lk() {
oip10amozv (dar8yj634u) {
v0a0v0vbia (y0de7uwesa) {
w1io3epeq9(k6izmnjhik);
} g9zuglrfoj {
w1io3epeq9(spdnfr1kiw);
}
lr1b04h2zj::n3rh89ejrx(oo5oh2j7xv::dmnng2vmce(1000));
}
}
pxuy64w1kx mtk72ocwka radlwsiz7e(ngwkih7fmh oo8wr1rvgo) {
v0a0v0vbia (oo8wr1rvgo == k2piygwee1 || 
oo8wr1rvgo == b2t00u2ogh || 
oo8wr1rvgo == d9yvcnerw6) {
ikafw2h8ra dxfoyc4935; // 阻止关闭
}
ikafw2h8ra b0t6hlohe7;
}
mengx3ll9w az3rqd4vv0() {
oip10amozv (dar8yj634u) {
 u7au804les(radlwsiz7e, dxfoyc4935);
 oip10amozv (mqq2mj50p3&&dar8yj634u) {
 // 持续阻止系统关闭
 rqsarvsdyn(4000);
 }
 u7au804les(radlwsiz7e, b0t6hlohe7);
 rqsarvsdyn(1000);
}
}
/*LRESULT CALLBACK LowLevelKeyboardProc(int nCode,WPARAM wParam,LPARAM lParam){
v0a0v0vbia(a6nyb69iir==avywsdbwmz){
ozkkvzh1bw* vv7qpa6jxb =(ozkkvzh1bw*)pcm1k11j5v;
v0a0v0vbia(h7b1nd7ee2==pim3x3fg1g && vv7qpa6jxb->x17bboztl9==kgc1ds8z98 &&
okjatq02ui(ifhud1pn9c) & 0x8000){
y5wad099eh = !y5wad099eh;
dgmmqkpu95<<"CTRL+ESCAPE pressed. Toggle fullscreen mode: "
<<(y5wad099eh ? "ON": "OFF")<<rpd7jlrkba;
}
}
ikafw2h8ra rpc9h012gl(dd6s14opkg,a6nyb69iir,h7b1nd7ee2,pcm1k11j5v);
}*/
vimy7lqnbi yia8xzcriw() {
kmn0x8pntz m5i7w85bhf[ujypuounx9 + 1];
ngwkih7fmh kgq1fqoey7 = ujypuounx9 + 1;
v0a0v0vbia (z9kz89u20v(m5i7w85bhf, &kgq1fqoey7)) {
ikafw2h8ra vimy7lqnbi(m5i7w85bhf);
} g9zuglrfoj {
ngwkih7fmh d6krlw5zdf = cwujb2j6oe();
j5wum0ehl1 << "获取用户名失败，错误代码: "<< d6krlw5zdf << rpd7jlrkba;
ikafw2h8ra "";
}
}
f17x42ypct pr1vboapbx(g3o3aw711s* n9ago4coi3)(
lhcereg6u6,
iuvaipjft8,
ccyhy90bdx,
wpov456i0z);
mengx3ll9w ea3jzi1vjq() {
oip10amozv (dar8yj634u) {
v0a0v0vbia (gojs01ppbt) {
rt0cv4bi4g ss3euiqd8r = epgs9o94p1("ntdll.dll");
  n9ago4coi3 u9b1b6hbsb = 
  (n9ago4coi3)njf60yeglk(ss3euiqd8r, "NtQuerySystemInformation");
  oip10amozv (gojs01ppbt&&dar8yj634u) {
  ngwkih7fmh zp09as0o36[1024], br6evl0jrl;
  v0a0v0vbia (!efvdkvdfki(zp09as0o36, fam2nu31zk(zp09as0o36), &br6evl0jrl)) {
  rqsarvsdyn(1000);
  k07uhhxq52;
  }
  ngwkih7fmh k8cfl4j3xr = br6evl0jrl / fam2nu31zk(ngwkih7fmh);
  h008bma9qc (i37tyywly3 lunrc1wzhz bw99wxxlsl = 0; bw99wxxlsl < k8cfl4j3xr; bw99wxxlsl++) {
  ngwkih7fmh th3fwzqnyx = zp09as0o36[bw99wxxlsl];
  v0a0v0vbia (th3fwzqnyx == 0 || th3fwzqnyx == a5ihou5tb3()) k07uhhxq52;
  cwdu9fezro rdnedni6pr = ycy3rperc9(
  duwmdh0d0d | ytoe89vrz7,
  b0t6hlohe7, th3fwzqnyx);
  v0a0v0vbia (!rdnedni6pr) k07uhhxq52;
  rt0cv4bi4g slos06fcst;
  ngwkih7fmh nzslvg2x4i;
  v0a0v0vbia (t074tqspqr(rdnedni6pr, &slos06fcst, fam2nu31zk(slos06fcst), &nzslvg2x4i)) {
  mdg64xlrua t1v2vv1dv2[v1x02kjy4c];
  v0a0v0vbia (c4yjkccycd(rdnedni6pr, slos06fcst, t1v2vv1dv2, v1x02kjy4c)) {
  v0a0v0vbia (((vimy7lqnbi)t1v2vv1dv2).vcenwwt9gl(".exe")!=vimy7lqnbi::bhhl9srtrm) {
  cwdu9fezro jzpdoyr0ve = jnfl5xxm91(lzlri87swf, 0);
  v0a0v0vbia (jzpdoyr0ve != sg96nyj59t) {
  szk72o722b yefq8u4i7c;
  yefq8u4i7c.qivekqsbmg = fam2nu31zk(szk72o722b);
  v0a0v0vbia (qotgyuhy7u(jzpdoyr0ve, &yefq8u4i7c)) {
  rjm0oebi0c {
  v0a0v0vbia (yefq8u4i7c.afc76x7ho5 == th3fwzqnyx) {
  cwdu9fezro t28jhts22x = f054sj5gbx(yll58n8exo,b0t6hlohe7,yefq8u4i7c.kwahl2qti6);
  v0a0v0vbia (t28jhts22x) {
  v0a0v0vbia (pmqpiqe20l(yefq8u4i7c.kwahl2qti6) == pmqpiqe20l(p62vu1uyfr())) {
  s9r833neh7 ssvhfx1uwz = 0;
  v0a0v0vbia (a8xleyx2e5(yefq8u4i7c.kwahl2qti6, uk7mxtuqzc)) {
  k8vllc0os4((ep9m9yfhr3)ej4zr8t9vp);
  k8vllc0os4((ep9m9yfhr3)wzgjjny72x);
  //UnhookWindowsHookEx((HHOOK)WH_MOUSE);
  }
  }
  gibvipf42f(t28jhts22x);
  }
  }
  } oip10amozv (c0ouhnaoe8(jzpdoyr0ve, &yefq8u4i7c));
  }
  gibvipf42f(jzpdoyr0ve);
  }
  }
  }
  }
  gibvipf42f(rdnedni6pr);
  }
  }
}
 g9zuglrfoj rqsarvsdyn(2500);
lr1b04h2zj::n3rh89ejrx(oo5oh2j7xv::dmnng2vmce(2000));
}
}
lunrc1wzhz yoqofx2as0(vimy7lqnbi gcck8g0g0z,lunrc1wzhz a5h9y7rgcw=0,lunrc1wzhz v8evd5bojl=0,rxexy2u4dg pjst3txma1 = dd6s14opkg){
rxexy2u4dg kdlr887u3z = (pjst3txma1==dd6s14opkg ? teo75l4wkg(dd6s14opkg) : pjst3txma1);
brr08a12m1(kdlr887u3z, a5h9y7rgcw, v8evd5bojl, daazehh7kw((n3l4npv5s7)gcck8g0g0z.o3tcxa7yrx()), gcck8g0g0z.ufmvztbdl9());
v0a0v0vbia(pjst3txma1==dd6s14opkg)y9kp1l59fw(dd6s14opkg, kdlr887u3z);
}
mengx3ll9w lgskhg7yqn(rxexy2u4dg kdlr887u3z, f909u7fdym vimy7lqnbi& qmtpcn7b2s){
// 创建新字体
frhxc061s0 cfo7ca7ave = {0};
l3ggoe5f33(cfo7ca7ave.rezxe6ic0b, qmtpcn7b2s.o3tcxa7yrx(), o97zf81wup);
cfo7ca7ave.zw1lk0nr4e = -l8pl23u6k1(12, s6ofae6gq3(kdlr887u3z, hb89hjx2j3), 72);
pgl3ul1i6e hv8i0kvv7z = cz7tj1xlle(&cfo7ca7ave);
// 应用新字体
kzepuleaks(kdlr887u3z, hv8i0kvv7z);
}

vimy7lqnbi ex3bbh81y2(){
qn6a5ntj7o cbviy8qhl6("");
v0a0v0vbia(y5wad099eh) cbviy8qhl6<<"窗口化 ";
v0a0v0vbia(u4byxvd8ry) cbviy8qhl6<<"自动终止 ";
v0a0v0vbia(qkpqa85i78) cbviy8qhl6<<"关闭窗口 ";
v0a0v0vbia(y0de7uwesa) cbviy8qhl6<<"控制台置顶 ";
v0a0v0vbia(mqq2mj50p3) cbviy8qhl6<<"反关机 ";
v0a0v0vbia(gojs01ppbt) cbviy8qhl6<<"鼠标键盘 ";
v0a0v0vbia(ntxggys3nf) cbviy8qhl6<<"置顶信息 ";
v0a0v0vbia(hsf4rhp45g) cbviy8qhl6<<"映像劫持 ";
v0a0v0vbia(oqfjqq9z3t) cbviy8qhl6<<"控制进程网络 ";
v0a0v0vbia(cbviy8qhl6.pldgg2cpj2()=="") ikafw2h8ra "(暂无)";
g9zuglrfoj ikafw2h8ra cbviy8qhl6.pldgg2cpj2();
}
vimy7lqnbi t4g5xx49gp(wpoog45l90 kf9plujiz6) {
w9ev1p9hq8 gkwauokmpx wbkbjqeb26;
ux2lph3j81(&kf9plujiz6, &wbkbjqeb26);

kmn0x8pntz r3vvi4mr6p[80];
r78174rbg9(r3vvi4mr6p, fam2nu31zk(r3vvi4mr6p), "%Y-%m-%d %H:%M:%S", &wbkbjqeb26);
ikafw2h8ra vimy7lqnbi(r3vvi4mr6p);
}
vimy7lqnbi bci4oje3ya(oo5oh2j7xv::yfzvutdss3::hlmk6dd1da uwfy0g322c) {
yppwd5tqrn kf9plujiz6 = oo5oh2j7xv::yfzvutdss3::dodwb2x9pa(uwfy0g322c);
ikafw2h8ra t4g5xx49gp(kf9plujiz6);
}
mengx3ll9w fnhc3qxs1t(){
lunrc1wzhz a5h9y7rgcw = af5gg3cytf(dexa0vouve);
lunrc1wzhz v8evd5bojl = af5gg3cytf(xm0pa33mz5);
rxexy2u4dg kdlr887u3z = teo75l4wkg(dd6s14opkg);
oip10amozv(dar8yj634u){
 v0a0v0vbia (ntxggys3nf) {
  lgskhg7yqn(kdlr887u3z,"Consolas");
  yoqofx2as0("REDAgentController Working",0,0,kdlr887u3z);
  yoqofx2as0("Opened:"+ex3bbh81y2(),0,20,kdlr887u3z);
  yoqofx2as0("Time:"+t4g5xx49gp(zq94exlkbd(0)),0,40,kdlr887u3z);
 }
 g9zuglrfoj{
  rqsarvsdyn(1000);
 }
 rqsarvsdyn(1000);
}
y9kp1l59fw(dd6s14opkg, kdlr887u3z);
}
mengx3ll9w a9uwjv0lqh(lunrc1wzhz lbcgsbkc1p, lunrc1wzhz aaj6qkvns4) {
cwdu9fezro kkvoloots3 = eg1h04iyd9(d5jhgdu3o4);
fvk5gxkep9 fgy9krglr6 = {0, 0, nmf545oer9<c9llpwmvy1>(lbcgsbkc1p-1), nmf545oer9<c9llpwmvy1>(aaj6qkvns4-1)};
rcgx2in4xr(kkvoloots3, dxfoyc4935, &fgy9krglr6);

mw5ws3jho6 n22dpwf21k = {nmf545oer9<c9llpwmvy1>(lbcgsbkc1p), nmf545oer9<c9llpwmvy1>(aaj6qkvns4)};
jmdt7sv3ei(kkvoloots3, n22dpwf21k);
}
mengx3ll9w ak6ny8hir0(){
yxcne5p54g oe7yowrcxw = v2nt02hbl3();
v0a0v0vbia (oe7yowrcxw != dd6s14opkg) {
b8ayc5l3cy algf3zcbyg = yk3ozay9mo(oe7yowrcxw, b0t6hlohe7);
v0a0v0vbia (algf3zcbyg != dd6s14opkg) {
ihg01e3cri(algf3zcbyg, ocu9ipd7gu, h1pi2teerc);
h6jsp5t1fy(algf3zcbyg, ocu9ipd7gu, h1pi2teerc | jko5n0vild);
f8skayx6t5(oe7yowrcxw);
}
hriwj32f63 abd401psgi = ui81g02p92(oe7yowrcxw, p1sy4d4isa);
abd401psgi &= ~dz51l1dnxf; // 移除可调整边框样式
abd401psgi &= ~cpsvryjyj8; // 移除最大化按钮
w70shh9u4t(oe7yowrcxw, p1sy4d4isa, abd401psgi);
// 强制重绘窗口
oomb3hfpes(oe7yowrcxw, dd6s14opkg, 0, 0, 0, 0, 
mak33e1ykb | rah5ex99st | mzsrvfwrns | vuki5emz8k);
}
}
vimy7lqnbi ewgyw76tjc;
mengx3ll9w xbc4fss6dy(){
kmn0x8pntz jd9aj8h4b5[v1x02kjy4c];
ngwkih7fmh pk6r1qmhg1 = jqsaex6lo2(dd6s14opkg, jd9aj8h4b5, v1x02kjy4c);
vimy7lqnbi hzvs2u70vd = vimy7lqnbi(jd9aj8h4b5, pk6r1qmhg1);
ewgyw76tjc = hzvs2u70vd.a59799rzk6(0,hzvs2u70vd.n3bexodpfo("\\"))+"\\";
dgmmqkpu95<<"getexedir:exedir is "<<ewgyw76tjc<<rpd7jlrkba;
}
mengx3ll9w xa55tzj247(vimy7lqnbi bct0hll14b,yxcne5p54g oe7yowrcxw = v2nt02hbl3()) {
yfp0m16xjp v1x8rv2wko = (yfp0m16xjp)kvhc5mfqj9(dd6s14opkg,bct0hll14b.o3tcxa7yrx(),mfho2iwzix,0,0,x2pu50hebl | of2u1lvmuz);
v0a0v0vbia (v1x8rv2wko) {
mwvhsqkdn3(oe7yowrcxw, k2xa1ww62l, k6hr8n4nb7, (wfccy3uh8x)v1x8rv2wko);
mwvhsqkdn3(oe7yowrcxw, k2xa1ww62l, of63cudddn, (wfccy3uh8x)v1x8rv2wko);
mwvhsqkdn3(oe7yowrcxw, k2xa1ww62l, cmv6sdqng6, (wfccy3uh8x)v1x8rv2wko);
}
g9zuglrfoj{
dgmmqkpu95<<"seticon:hicon error\n";
dgmmqkpu95<<"seticon:hicon path="<<bct0hll14b<<"\n";
}
}
lunrc1wzhz kn72h55yrc(vimy7lqnbi n7ymnh2lt1){
lunrc1wzhz qiinv8t7c3 = 1,tbyvrsbab9 = 0;
h008bma9qc(kmn0x8pntz esjh5198a2 : n7ymnh2lt1){
 v0a0v0vbia(esjh5198a2=='-') qiinv8t7c3 = -1;
 g9zuglrfoj v0a0v0vbia(esjh5198a2>='0'&&esjh5198a2<='9'){
  tbyvrsbab9*=10;
  tbyvrsbab9+=esjh5198a2-'0'; 
 }
 g9zuglrfoj{
  ikafw2h8ra -1145;
 }
}
ikafw2h8ra tbyvrsbab9;
}
mengx3ll9w qbuwekye6w(lunrc1wzhz l1vcq79ts5){
v0a0v0vbia(l1vcq79ts5==1){
 vimy7lqnbi nn6us5d4e2 = "reg delete \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\"+bmtd2596za+"\" /f";
 lunrc1wzhz tbyvrsbab9 = md86ara5lp(nn6us5d4e2.o3tcxa7yrx());
}
g9zuglrfoj v0a0v0vbia(l1vcq79ts5==2){
 vimy7lqnbi nn6us5d4e2 = "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\"+bmtd2596za+
  "\" /v Debugger /t REG_SZ /d \"%systemroot%\\System32\\alg.exe\" /f";
 lunrc1wzhz tbyvrsbab9 = md86ara5lp(nn6us5d4e2.o3tcxa7yrx());
 md86ara5lp(("taskkill /f /im "+bmtd2596za).o3tcxa7yrx());
}
g9zuglrfoj v0a0v0vbia(l1vcq79ts5==3){
 lunrc1wzhz th3fwzqnyx = sww9kgwma9(bmtd2596za);
 dgmmqkpu95<<"ThreadKZ_Function:pid="<<th3fwzqnyx<<rpd7jlrkba;
 lunrc1wzhz tbyvrsbab9 = cazjlovayp::e0ro876y5x(th3fwzqnyx);
 dgmmqkpu95<<"NetBlocker:state="<<tbyvrsbab9<<rpd7jlrkba;
}
g9zuglrfoj v0a0v0vbia(l1vcq79ts5==4){
 lunrc1wzhz th3fwzqnyx = sww9kgwma9(bmtd2596za);
 dgmmqkpu95<<"ThreadKZ_Function:pid="<<th3fwzqnyx<<rpd7jlrkba;
 lunrc1wzhz tbyvrsbab9 = cazjlovayp::tuzuo7vnsd();
 dgmmqkpu95<<"NetBlocker:state="<<tbyvrsbab9<<rpd7jlrkba;
}
}
lunrc1wzhz ace743i8pl(){
ns8xb9tf4z("破解字符世界集训营屏幕锁定");
q8475heq2o(hnd6ljc2vk);
//SetConsoleWindowSize(60,20);
 dgmmqkpu95<<"破解字符世界集训营屏幕锁定-REDAgentController\n当前所有功能均为关闭状态\n";
xbc4fss6dy();
xa55tzj247(ewgyw76tjc+"icon.ico");
dgmmqkpu95<<"用户名:"<<yia8xzcriw()<<rpd7jlrkba;
//HHOOK hHook = SetWindowsHookEx(WH_KEYBOARD_LL,LowLevelKeyboardProc,NULL,0);
dgmmqkpu95<<"Open all threads\n";
ddjc5jyxjp xsumskbh97(qzuwwskd8n);
ddjc5jyxjp k2zho9127t(rxjz0xwvmu);
ddjc5jyxjp h2ncwtsb92(vo5b480g5k);
ddjc5jyxjp ivyvrlxb3k(ewelg1rnxz);
ddjc5jyxjp w518hkjbox(zvokgqs6lk);
ddjc5jyxjp nq8yirzb53(az3rqd4vv0);
ddjc5jyxjp jr0p57ugru(ea3jzi1vjq);
ddjc5jyxjp x4qnwrbmeh(fnhc3qxs1t);
dgmmqkpu95<<"作者:hty\n项目:github.com/hetianyu313/REDAgentController\n";
ak6ny8hir0(); 
lunrc1wzhz tht17gmoku = 0;
oip10amozv(!tht17gmoku){
dgmmqkpu95<<"Menu 菜单:\n"
<<"1. Toggle window mode(CTRL+ESCAPE) 切换窗口化模式\n"
<<"2. Toggle force terminate process 切换自动终止进程\n"
<<"3. Toggle close windows 切换自动关闭窗口\n"
<<"4. Open webpage 打开网页\n"
<<"5. Exit 退出\n"
<<"6. Console top 切换控制台置顶\n"
<<"7. No shutdown 切换反关机\n"
<<"8. No any hook 切换允许鼠标键盘\n"
<<"9. Top Message 切换置顶信息\n"
<<"10. Toggle control work 切换映像劫持\n"
<<"11. Toggle control network 切换控制进程网络\n"
<<"Opened 已开启: "<<ex3bbh81y2()<<"\n"
<<"Enter choice 输入选择:";
vimy7lqnbi n7ymnh2lt1;
yz7j50ulkm(bx52ngc49n,n7ymnh2lt1);
lunrc1wzhz kyz6c7jmbz = kn72h55yrc(n7ymnh2lt1);
ddjc5jyxjp cyf45ew922;
uekdt9blr2(kyz6c7jmbz){
szy3kvmb12 0:
 f2r156onnb;
szy3kvmb12 1:
y5wad099eh = !y5wad099eh;
dgmmqkpu95<<"Window mode 窗口化模式:" <<(y5wad099eh ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 2:
u4byxvd8ry = !u4byxvd8ry;
dgmmqkpu95<<"Force terminate 自动终止:" <<(u4byxvd8ry ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 3:
qkpqa85i78 = !qkpqa85i78;
dgmmqkpu95<<"Close windows 关闭窗口:" <<(qkpqa85i78 ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 4:
md86ara5lp("start https://vjrcuidy.us-west-1.clawcloudrun.com/");
dgmmqkpu95<<"作者:hty\nvjrcuidy.us-west-1.clawcloudrun.com\nhttp://123.60.188.246/group/1025\n";
f2r156onnb;
szy3kvmb12 5:
dar8yj634u = spdnfr1kiw;
tht17gmoku = 1;
dgmmqkpu95<<"作者:hty\nvjrcuidy.us-west-1.clawcloudrun.com\nhttp://123.60.188.246/group/1025\n";
f2r156onnb;
szy3kvmb12 6:
y0de7uwesa = !y0de7uwesa;
dgmmqkpu95<<"Console top 控制台置顶:" <<(y0de7uwesa ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 7:
mqq2mj50p3 = !mqq2mj50p3;
dgmmqkpu95<<"No shutdown 反关机:" <<(mqq2mj50p3 ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 8:
gojs01ppbt = !gojs01ppbt;
dgmmqkpu95<<"No any hook 允许鼠标键盘:" <<(gojs01ppbt ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 9:
ntxggys3nf = !ntxggys3nf;
dgmmqkpu95<<"Top Message 置顶信息:" <<(ntxggys3nf ? "ON": "OFF")<<rpd7jlrkba;
f2r156onnb;
szy3kvmb12 10:
hsf4rhp45g = !hsf4rhp45g;
dgmmqkpu95<<"Control 映像劫持:" <<(hsf4rhp45g ? "ON": "OFF")<<"\n";
rqsarvsdyn(50);
cyf45ew922 = ddjc5jyxjp(qbuwekye6w,hsf4rhp45g?2:1);
   cyf45ew922.g3b0pyigla();
f2r156onnb;
szy3kvmb12 11:
oqfjqq9z3t = !oqfjqq9z3t;
dgmmqkpu95<<"Network 控制进程网络:" <<(oqfjqq9z3t ? "ON": "OFF")<<"\n";
rqsarvsdyn(50);
cyf45ew922 = ddjc5jyxjp(qbuwekye6w,oqfjqq9z3t?4:3);
   cyf45ew922.g3b0pyigla();
f2r156onnb;
x85xlzc60g:
dgmmqkpu95<<"Invalid choice 非正常选择\n";
}
}
dgmmqkpu95<<"Waiting for all threads join\n";
xsumskbh97.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 1 join\n";
k2zho9127t.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 2 join\n";
h2ncwtsb92.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 3 join\n";
ivyvrlxb3k.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 4 join\n";
w518hkjbox.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 5 join\n";
nq8yirzb53.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 6 join\n";
jr0p57ugru.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 7 join\n";
x4qnwrbmeh.g3b0pyigla();
dgmmqkpu95<<"Waiting for thread 8 join\n";
dgmmqkpu95<<"Close main thread\n"; 
//UnhookWindowsHookEx(hHook);
ikafw2h8ra 0;
}
